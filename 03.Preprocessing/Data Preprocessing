{"cells":[{"cell_type":"markdown","metadata":{"id":"xBaMznhV72Xg"},"source":["# Data Preprocessing"]},{"cell_type":"markdown","source":["## Install Necessary Libraries"],"metadata":{"id":"lLQDzGBLrUnX"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"zNrCXd0mllBi","executionInfo":{"status":"ok","timestamp":1688117468040,"user_tz":-120,"elapsed":9771,"user":{"displayName":"Beatriz Leitao","userId":"00922298846450358063"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"6adb8041-e5f5-481d-fbfc-4d220b4395c3"},"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[?25l     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.0/541.6 kB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m\r\u001b[2K     \u001b[91m━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[90m╺\u001b[0m\u001b[90m━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m256.0/541.6 kB\u001b[0m \u001b[31m8.2 MB/s\u001b[0m eta \u001b[36m0:00:01\u001b[0m\r\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m541.6/541.6 kB\u001b[0m \u001b[31m9.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Building wheel for wordninja (setup.py) ... \u001b[?25l\u001b[?25hdone\n"]},{"output_type":"stream","name":"stderr","text":["[nltk_data] Downloading package stopwords to /root/nltk_data...\n","[nltk_data]   Unzipping corpora/stopwords.zip.\n","[nltk_data] Downloading package punkt to /root/nltk_data...\n","[nltk_data]   Unzipping tokenizers/punkt.zip.\n"]}],"source":["!pip install wordninja --quiet\n","import pandas as pd\n","import numpy as np\n","import random\n","import string\n","import ast\n","import wordninja\n","import warnings\n","from scipy import sparse\n","from scipy.sparse import csc_matrix, lil_matrix, save_npz\n","from google.colab import drive\n","import nltk\n","from nltk.corpus import stopwords\n","from nltk.tokenize import word_tokenize\n","from nltk.stem import WordNetLemmatizer\n","nltk.download('stopwords')\n","nltk.download('punkt')\n","pd.set_option('display.max_colwidth', None)"]},{"cell_type":"markdown","source":["## Mount Google Drive"],"metadata":{"id":"8bFG0ctWrZea"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"ppLeJx2A71p8","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1688117492332,"user_tz":-120,"elapsed":14372,"user":{"displayName":"Beatriz Leitao","userId":"00922298846450358063"}},"outputId":"a62abb0e-4e6d-40df-afdc-21d341757962"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive', force_remount=True)"]},{"cell_type":"markdown","source":["# Choose Dataset Characteristics"],"metadata":{"id":"_mBdZD5U-cNG"}},{"cell_type":"code","source":["size = 'Small'\n","version = 'Train'"],"metadata":{"id":"XniCM9oI-AfM"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"M1XvmAH3PnLT"},"source":["## Clean News Dataset"]},{"cell_type":"markdown","source":["### Load & Visualize Input Datasets"],"metadata":{"id":"A1VAsB8w-iDu"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"hVkXAK2M923G"},"outputs":[],"source":["news = pd.read_csv(f\"/content/drive/MyDrive/Group_19/01.Dataset/{size}/Original/{version}/news.tsv\", header=None, sep='\\t', names=['News ID', 'Category', 'SubCategory', 'Title', 'Abstract', 'URL', 'Title Entities', 'Abstract Entities'], usecols=['News ID', 'Category', 'SubCategory', 'Title', 'Abstract', 'Title Entities', 'Abstract Entities'])"]},{"cell_type":"code","source":["news.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"hjKIeLz_yP4x","executionInfo":{"status":"ok","timestamp":1688054593106,"user_tz":-120,"elapsed":10,"user":{"displayName":"Vasco Oliveira","userId":"01429743951160621812"}},"outputId":"f77d8913-85c3-42c8-ab60-654557af0a4d"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["  News ID   Category      SubCategory  \\\n","0  N55528  lifestyle  lifestyleroyals   \n","1  N19639     health       weightloss   \n","2  N61837       news        newsworld   \n","3  N53526     health           voices   \n","4  N38324     health          medical   \n","\n","                                                                    Title  \\\n","0  The Brands Queen Elizabeth, Prince Charles, and Prince Philip Swear By   \n","1                                           50 Worst Habits For Belly Fat   \n","2         The Cost of Trump's Aid Freeze in the Trenches of Ukraine's War   \n","3             I Was An NBA Wife. Here's How It Affected My Mental Health.   \n","4               How to Get Rid of Skin Tags, According to a Dermatologist   \n","\n","                                                                                                                                                                                               Abstract  \\\n","0                                                                                                                             Shop the notebooks, jackets, and more that the royals can't live without.   \n","1                                                                                  These seemingly harmless habits are holding you back and keeping you from shedding that unwanted belly fat for good.   \n","2  Lt. Ivan Molchanets peeked over a parapet of sand bags at the front line of the war in Ukraine. Next to him was an empty helmet propped up to trick snipers, already perforated with multiple holes.   \n","3                                                                                                   I felt like I was a fraud, and being an NBA wife didn't help that. In fact, it nearly destroyed me.   \n","4                   They seem harmless, but there's a very good reason you shouldn't ignore them. The post How to Get Rid of Skin Tags, According to a Dermatologist appeared first on Reader's Digest.   \n","\n","                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Title Entities  \\\n","0  [{\"Label\": \"Prince Philip, Duke of Edinburgh\", \"Type\": \"P\", \"WikidataId\": \"Q80976\", \"Confidence\": 1.0, \"OccurrenceOffsets\": [48], \"SurfaceForms\": [\"Prince Philip\"]}, {\"Label\": \"Charles, Prince of Wales\", \"Type\": \"P\", \"WikidataId\": \"Q43274\", \"Confidence\": 1.0, \"OccurrenceOffsets\": [28], \"SurfaceForms\": [\"Prince Charles\"]}, {\"Label\": \"Elizabeth II\", \"Type\": \"P\", \"WikidataId\": \"Q9682\", \"Confidence\": 0.97, \"OccurrenceOffsets\": [11], \"SurfaceForms\": [\"Queen Elizabeth\"]}]   \n","1                                                                                                                                                                                                                                                                                                                                        [{\"Label\": \"Adipose tissue\", \"Type\": \"C\", \"WikidataId\": \"Q193583\", \"Confidence\": 1.0, \"OccurrenceOffsets\": [20], \"SurfaceForms\": [\"Belly Fat\"]}]   \n","2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      []   \n","3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      []   \n","4                                                                                                                                                                                                                                                                                                                                             [{\"Label\": \"Skin tag\", \"Type\": \"C\", \"WikidataId\": \"Q3179593\", \"Confidence\": 1.0, \"OccurrenceOffsets\": [18], \"SurfaceForms\": [\"Skin Tags\"]}]   \n","\n","                                                                                                                                                                                                                                                                                                                                                                                                                                          Abstract Entities  \n","0                                                                                                                                                                                                                                                                                                                                                                                                                                                        []  \n","1                                                                                                                                                                                                                                                                                                          [{\"Label\": \"Adipose tissue\", \"Type\": \"C\", \"WikidataId\": \"Q193583\", \"Confidence\": 1.0, \"OccurrenceOffsets\": [97], \"SurfaceForms\": [\"belly fat\"]}]  \n","2                                                                                                                                                                                                                                                                                                                    [{\"Label\": \"Ukraine\", \"Type\": \"G\", \"WikidataId\": \"Q212\", \"Confidence\": 0.946, \"OccurrenceOffsets\": [87], \"SurfaceForms\": [\"Ukraine\"]}]  \n","3                                                                                                                                                                                                                                                                                               [{\"Label\": \"National Basketball Association\", \"Type\": \"O\", \"WikidataId\": \"Q155223\", \"Confidence\": 1.0, \"OccurrenceOffsets\": [40], \"SurfaceForms\": [\"NBA\"]}]  \n","4  [{\"Label\": \"Skin tag\", \"Type\": \"C\", \"WikidataId\": \"Q3179593\", \"Confidence\": 1.0, \"OccurrenceOffsets\": [105], \"SurfaceForms\": [\"Skin Tags\"]}, {\"Label\": \"Dermatology\", \"Type\": \"C\", \"WikidataId\": \"Q171171\", \"Confidence\": 1.0, \"OccurrenceOffsets\": [131], \"SurfaceForms\": [\"Dermatologist\"]}, {\"Label\": \"Reader's Digest\", \"Type\": \"M\", \"WikidataId\": \"Q371820\", \"Confidence\": 0.999, \"OccurrenceOffsets\": [163], \"SurfaceForms\": [\"Reader's Digest\"]}]  "],"text/html":["\n","  <div id=\"df-e922b233-cae0-4f5d-a921-4fbb3b714e49\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>News ID</th>\n","      <th>Category</th>\n","      <th>SubCategory</th>\n","      <th>Title</th>\n","      <th>Abstract</th>\n","      <th>Title Entities</th>\n","      <th>Abstract Entities</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>N55528</td>\n","      <td>lifestyle</td>\n","      <td>lifestyleroyals</td>\n","      <td>The Brands Queen Elizabeth, Prince Charles, and Prince Philip Swear By</td>\n","      <td>Shop the notebooks, jackets, and more that the royals can't live without.</td>\n","      <td>[{\"Label\": \"Prince Philip, Duke of Edinburgh\", \"Type\": \"P\", \"WikidataId\": \"Q80976\", \"Confidence\": 1.0, \"OccurrenceOffsets\": [48], \"SurfaceForms\": [\"Prince Philip\"]}, {\"Label\": \"Charles, Prince of Wales\", \"Type\": \"P\", \"WikidataId\": \"Q43274\", \"Confidence\": 1.0, \"OccurrenceOffsets\": [28], \"SurfaceForms\": [\"Prince Charles\"]}, {\"Label\": \"Elizabeth II\", \"Type\": \"P\", \"WikidataId\": \"Q9682\", \"Confidence\": 0.97, \"OccurrenceOffsets\": [11], \"SurfaceForms\": [\"Queen Elizabeth\"]}]</td>\n","      <td>[]</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>N19639</td>\n","      <td>health</td>\n","      <td>weightloss</td>\n","      <td>50 Worst Habits For Belly Fat</td>\n","      <td>These seemingly harmless habits are holding you back and keeping you from shedding that unwanted belly fat for good.</td>\n","      <td>[{\"Label\": \"Adipose tissue\", \"Type\": \"C\", \"WikidataId\": \"Q193583\", \"Confidence\": 1.0, \"OccurrenceOffsets\": [20], \"SurfaceForms\": [\"Belly Fat\"]}]</td>\n","      <td>[{\"Label\": \"Adipose tissue\", \"Type\": \"C\", \"WikidataId\": \"Q193583\", \"Confidence\": 1.0, \"OccurrenceOffsets\": [97], \"SurfaceForms\": [\"belly fat\"]}]</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>N61837</td>\n","      <td>news</td>\n","      <td>newsworld</td>\n","      <td>The Cost of Trump's Aid Freeze in the Trenches of Ukraine's War</td>\n","      <td>Lt. Ivan Molchanets peeked over a parapet of sand bags at the front line of the war in Ukraine. Next to him was an empty helmet propped up to trick snipers, already perforated with multiple holes.</td>\n","      <td>[]</td>\n","      <td>[{\"Label\": \"Ukraine\", \"Type\": \"G\", \"WikidataId\": \"Q212\", \"Confidence\": 0.946, \"OccurrenceOffsets\": [87], \"SurfaceForms\": [\"Ukraine\"]}]</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>N53526</td>\n","      <td>health</td>\n","      <td>voices</td>\n","      <td>I Was An NBA Wife. Here's How It Affected My Mental Health.</td>\n","      <td>I felt like I was a fraud, and being an NBA wife didn't help that. In fact, it nearly destroyed me.</td>\n","      <td>[]</td>\n","      <td>[{\"Label\": \"National Basketball Association\", \"Type\": \"O\", \"WikidataId\": \"Q155223\", \"Confidence\": 1.0, \"OccurrenceOffsets\": [40], \"SurfaceForms\": [\"NBA\"]}]</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>N38324</td>\n","      <td>health</td>\n","      <td>medical</td>\n","      <td>How to Get Rid of Skin Tags, According to a Dermatologist</td>\n","      <td>They seem harmless, but there's a very good reason you shouldn't ignore them. The post How to Get Rid of Skin Tags, According to a Dermatologist appeared first on Reader's Digest.</td>\n","      <td>[{\"Label\": \"Skin tag\", \"Type\": \"C\", \"WikidataId\": \"Q3179593\", \"Confidence\": 1.0, \"OccurrenceOffsets\": [18], \"SurfaceForms\": [\"Skin Tags\"]}]</td>\n","      <td>[{\"Label\": \"Skin tag\", \"Type\": \"C\", \"WikidataId\": \"Q3179593\", \"Confidence\": 1.0, \"OccurrenceOffsets\": [105], \"SurfaceForms\": [\"Skin Tags\"]}, {\"Label\": \"Dermatology\", \"Type\": \"C\", \"WikidataId\": \"Q171171\", \"Confidence\": 1.0, \"OccurrenceOffsets\": [131], \"SurfaceForms\": [\"Dermatologist\"]}, {\"Label\": \"Reader's Digest\", \"Type\": \"M\", \"WikidataId\": \"Q371820\", \"Confidence\": 0.999, \"OccurrenceOffsets\": [163], \"SurfaceForms\": [\"Reader's Digest\"]}]</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-e922b233-cae0-4f5d-a921-4fbb3b714e49')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-e922b233-cae0-4f5d-a921-4fbb3b714e49 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-e922b233-cae0-4f5d-a921-4fbb3b714e49');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":155}]},{"cell_type":"markdown","metadata":{"id":"010ZMh6_RV1R"},"source":["### Transformations"]},{"cell_type":"code","source":["# define function to load embeddings into a dictionary\n","def load_embeddings(file_path):\n","    # Initialize an empty dictionary to store the vectors\n","    embeddings = {}\n","\n","    # Load embeddings into a dictionary\n","    with open(file_path, 'r') as file:\n","        for line in file:\n","            # Remove leading/trailing whitespaces and split by spaces\n","            line = line.strip().split()\n","            # The first element is the vector ID\n","            embedding_id = line[0]\n","            # Convert the remaining elements to floats\n","            embedding_components = [float(x) for x in line[1:]]\n","            # Assign the vector components to the vector ID in the dictionary\n","            embeddings[embedding_id] = embedding_components\n","\n","    # Convert embeddings from lists to numpy arrays\n","    clean_embeddings = {}\n","\n","    # Iterate through key value pairs to convert values to arrays\n","    for key, value in embeddings.items():\n","        clean_embeddings[key] = np.array(value)\n","\n","    # There are about 12% of news which don't have entities for neither the title or the abstract\n","\n","    return clean_embeddings"],"metadata":{"id":"XG5xYkzIQAKl"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["embeddings = load_embeddings(f\"/content/drive/MyDrive/Group_19/01.Dataset/{size}/Original/{version}/entity_embedding.vec\")"],"metadata":{"id":"dBwZMSB0Qo0X"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def get_clean_news(news, embeddings):\n","\n","  # Remove rows with missing values (which is this case are 2666 news that have no abstract)\n","  news.dropna(inplace=True)\n","\n","  # duplicates = news.duplicated(keep=False)  # keep=False marks all duplicates as True\n","  # duplicate_rows = news.loc[duplicates]\n","\n","  # len(duplicate_rows.loc[(duplicate_rows.Category=='weather') & (duplicate_rows.Abstract==\"What's the weather today? What's the weather for the week? Here's your forecast.\")])\n","\n","  #There are only 36 of those which are weather based, especially given that we don't have real dates for the news, i think we should drop\n","  #From looking at the rest, most are actually fully duplicated\n","\n","  # Remove duplicate rows that\n","  news.drop_duplicates(inplace=True)\n","\n","  # Define the split_and_replace function\n","  def split_and_replace(word):\n","      split_words = wordninja.split(word)\n","      new_word = ' '.join(split_words)\n","      return new_word\n","\n","  # Apply split_and_replace function to 'Category' and 'SubCategory' columns\n","  news['Category'] = news['Category'].apply(lambda x: split_and_replace(x))\n","  news['SubCategory'] = news['SubCategory'].apply(lambda x: split_and_replace(x))\n","\n","  # Define the columns to be converted to lowercase\n","  columns_to_lower = ['Category', 'SubCategory', 'Title', 'Abstract']\n","\n","  # Convert selected columns to lowercase\n","  news[columns_to_lower] = news[columns_to_lower].applymap(lambda x: x.lower() if isinstance(x, str) else x)\n","\n","  # Create a new column 'Content' by combining 'Category', 'SubCategory', 'Title', and 'Abstract'\n","  news['Content'] = news[['Category', 'SubCategory', 'Title', 'Abstract']].apply(' '.join, axis=1)\n","\n","  # Remove punctuation from 'content'\n","  news['Content'] = news['Content'].str.replace('[{}]'.format(string.punctuation), '', regex=True)\n","\n","  # Define english stop words\n","  stop_words  = set(stopwords.words('english'))\n","\n","  # Remove stopwords from history_content\n","  news['Content'] = [word for word in news['Content'] if word.lower() not in stop_words]\n","\n","  # Calculate the word count of the 'Content' column\n","  news['Content_WC'] = news['Content'].str.split().str.len()\n","\n","  ## Use embeddings to extract the title and abstract's average vector\n","\n","  # convert title & abstract entities object from string to list of dictionaries\n","  news['Title Entities'] = news['Title Entities'].apply(ast.literal_eval)\n","  news['Abstract Entities'] = news['Abstract Entities'].apply(ast.literal_eval)\n","\n","  # create columns with title & abstract wiki data ids\n","  news['Title Wikidata IDs'] = news['Title Entities'].apply(lambda x: ' '.join([dict['WikidataId'] for dict in x]))\n","  news['Abstract Wikidata IDs'] = news['Abstract Entities'].apply(lambda x: ' '.join([dict['WikidataId'] for dict in x]))\n","\n","  # concatenate title & abstract wiki data ids\n","  news['All Wikidata IDs'] = news['Title Wikidata IDs'] + ' ' + news['Abstract Wikidata IDs']\n","\n","  # Function to calculate the average vector given a list of vector IDs and the embeddings dictionary\n","  def calculate_average_vector(vector_ids, embeddings):\n","    # get list of vectors corresponsing to vector IDs specified\n","    vectors = [embeddings.get(vector_id) for vector_id in vector_ids if vector_id in embeddings]\n","    if vectors:\n","        return np.mean(vectors, axis=0)\n","    else:\n","        return np.nan\n","\n","  # Create new column with average vector\n","  news['Average Vector'] = news['All Wikidata IDs'].apply(lambda x: calculate_average_vector(x.split(), embeddings))\n","\n","  ## Impute missing values with average vector of category & subcategory\n","\n","  # Create a subset of df news without NAs\n","  subset = news.dropna(subset=['Average Vector'])\n","\n","  # Calculate average vector per 'Category' and 'Subcategory'\n","  average_vector_per_cat_and_subcat = subset.groupby(['Category', 'SubCategory'])['Average Vector'].mean()\n","\n","  # Convert dataframe to mapping dictionary\n","  mapping_dict = average_vector_per_cat_and_subcat.to_dict()\n","\n","  # Use mapping dictionary to fill NAs\n","  news['Average Vector'] = news.apply(\n","      lambda row: mapping_dict.get((row['Category'], row['SubCategory']))\n","      if (row['Average Vector'] is np.nan)\n","      else row['Average Vector'],\n","      axis=1\n","  )\n","\n","  ## Repeat process to impute reamining missing values with average vector of category\n","\n","  # Create a subset of df news without NAs\n","  subset = news.dropna(subset=['Average Vector'])\n","\n","  # Calculate the average vector per 'Category'\n","  average_vector_per_cat = subset.groupby(['Category'])['Average Vector'].mean()\n","\n","  #Convert dataframe to mapping dictionary\n","  mapping_dict = average_vector_per_cat.to_dict()\n","\n","  # Use mapping dictionary to fill NAs\n","  news['Average Vector'] = news.apply(\n","      lambda row: mapping_dict.get(row['Category'])\n","      if (row['Average Vector'] is None)\n","      else row['Average Vector'],\n","      axis=1\n","  )\n","\n","  # Drop unnecessary columns\n","  news.drop(columns=['Title Entities', 'Abstract Entities', 'Title Wikidata IDs', 'Abstract Wikidata IDs', 'All Wikidata IDs'], inplace=True)\n","\n","  return news"],"metadata":{"id":"smdJaydNzBeq"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zFlRLlnU-mbC"},"outputs":[],"source":["news = get_clean_news(news, embeddings)"]},{"cell_type":"code","source":["news.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"mO7q_FdyqErB","executionInfo":{"status":"ok","timestamp":1688054611748,"user_tz":-120,"elapsed":39,"user":{"displayName":"Vasco Oliveira","userId":"01429743951160621812"}},"outputId":"7dc66bbd-ffc7-4045-d3c1-7b9723b94b20"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["  News ID   Category       SubCategory  \\\n","0  N55528  lifestyle  lifestyle royals   \n","1  N19639     health       weight loss   \n","2  N61837       news        news world   \n","3  N53526     health            voices   \n","4  N38324     health           medical   \n","\n","                                                                    Title  \\\n","0  the brands queen elizabeth, prince charles, and prince philip swear by   \n","1                                           50 worst habits for belly fat   \n","2         the cost of trump's aid freeze in the trenches of ukraine's war   \n","3             i was an nba wife. here's how it affected my mental health.   \n","4               how to get rid of skin tags, according to a dermatologist   \n","\n","                                                                                                                                                                                               Abstract  \\\n","0                                                                                                                             shop the notebooks, jackets, and more that the royals can't live without.   \n","1                                                                                  these seemingly harmless habits are holding you back and keeping you from shedding that unwanted belly fat for good.   \n","2  lt. ivan molchanets peeked over a parapet of sand bags at the front line of the war in ukraine. next to him was an empty helmet propped up to trick snipers, already perforated with multiple holes.   \n","3                                                                                                   i felt like i was a fraud, and being an nba wife didn't help that. in fact, it nearly destroyed me.   \n","4                   they seem harmless, but there's a very good reason you shouldn't ignore them. the post how to get rid of skin tags, according to a dermatologist appeared first on reader's digest.   \n","\n","                                                                                                                                                                                                                                                                          Content  \\\n","0                                                                                                           lifestyle lifestyle royals the brands queen elizabeth prince charles and prince philip swear by shop the notebooks jackets and more that the royals cant live without   \n","1                                                                                                            health weight loss 50 worst habits for belly fat these seemingly harmless habits are holding you back and keeping you from shedding that unwanted belly fat for good   \n","2  news news world the cost of trumps aid freeze in the trenches of ukraines war lt ivan molchanets peeked over a parapet of sand bags at the front line of the war in ukraine next to him was an empty helmet propped up to trick snipers already perforated with multiple holes   \n","3                                                                                                           health voices i was an nba wife heres how it affected my mental health i felt like i was a fraud and being an nba wife didnt help that in fact it nearly destroyed me   \n","4                            health medical how to get rid of skin tags according to a dermatologist they seem harmless but theres a very good reason you shouldnt ignore them the post how to get rid of skin tags according to a dermatologist appeared first on readers digest   \n","\n","   Content_WC  \\\n","0          26   \n","1          28   \n","2          51   \n","3          35   \n","4          44   \n","\n","                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Average Vector  \n","0  [0.004057333333333334, -0.03991733333333333, -0.008374, 0.07914233333333333, -0.020229666666666663, -0.022213, 0.040847666666666664, 0.0014350000000000005, 0.061828666666666664, -0.031631, 0.023040333333333333, 0.04310766666666666, 0.023592, -0.061693, 0.015099000000000001, -0.07910833333333334, 0.028382666666666667, 0.10652766666666667, -0.008534333333333333, -0.01902066666666667, 0.011596, -0.092748, 0.07943733333333333, -0.08211, -0.07028966666666668, -0.10451899999999999, 0.011144333333333334, -0.009591, 0.04464566666666667, -0.081025, -0.06339066666666666, -0.020261666666666667, 0.08129033333333334, 0.031477333333333336, -0.07450066666666667, 0.012981, -0.003404666666666667, 0.010823333333333332, -0.065875, 0.017982, -0.055929666666666676, 0.08072766666666667, -0.07246833333333333, 0.025115, -0.11045533333333334, 0.041048, -0.011876000000000003, -0.00434, -0.002706999999999999, -0.001977333333333333, 0.022897666666666667, 0.066106, 0.010144333333333333, 0.04570766666666667, 0.044172333333333334, 0.07795266666666667, 0.014355333333333331, 0.07450999999999999, -0.038349666666666664, -0.011252666666666666, 0.09210466666666665, -0.07734766666666666, 0.035256, -0.05846233333333334, 0.061819000000000006, 0.08261533333333333, 0.029722666666666665, 0.029845999999999998, -0.035560666666666664, 0.05244833333333334, -0.004362, 0.02662, -0.05474266666666666, 0.0003316666666666653, -0.019636666666666667, -0.004569333333333334, 0.03388133333333333, -0.021329333333333336, 0.0013953333333333328, 0.082415, 0.06908733333333333, -0.011366000000000001, -0.0005483333333333335, 0.013892, -0.011874000000000001, -0.063751, 0.076371, 0.03708566666666667, -0.001979999999999999, -0.027107666666666665, -0.073342, 0.014615999999999999, 0.05578533333333333, 0.024075666666666672, 0.026349333333333332, -0.05218166666666666, 0.046934, -0.024919666666666663, 0.07169866666666667, -0.03612766666666667]  \n","1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 [-0.013597, -0.009758, 0.01712, -0.051993, 0.037963, 0.045238, 0.077176, -0.033402, 0.032126, 0.000231, -0.041168, 0.006686, -0.042137, 0.003012, -0.007492, 0.004021, -0.044446, 0.060362, 0.036527, 0.000915, -0.0881, 0.013638, 0.00664, 0.023534, -0.006483, -0.030089, -0.01769, -0.076201, 0.010523, -0.015482, -0.029464, -0.000577, 0.011122, 0.020931, 0.019831, -0.020024, 0.046285, -0.087435, -0.014035, -0.032755, 0.000882, 0.058146, -0.063754, -0.01612, -0.028519, -0.006055, 0.043857, 0.012439, 0.008123, 0.068035, -0.025732, -0.082524, 0.012157, 0.005102, 0.050669, -0.029057, -0.097563, 0.01637, 0.104147, -0.013962, -0.085338, 0.002964, 0.002371, 0.033141, -0.094885, -0.041572, -0.083391, -0.017752, -0.021868, 0.003052, 0.065026, 0.018371, -0.009355, 0.078348, 0.028948, -0.043366, 0.007608, 0.031137, 0.054513, 0.030671, -0.021131, -0.048048, -0.013872, -0.000741, -0.059595, -0.109701, 0.046302, 0.016114, 0.05821, -0.015325, -0.085929, -0.059981, 0.004588, -0.028985, -0.059973, -0.035562, 0.106053, -0.10042, 0.051723, 0.001144]  \n","2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      [-0.065324, -0.088163, -0.015203, -0.031949, 0.091263, -0.228807, -0.005629, -0.199308, 0.158042, 0.157506, 0.112573, 0.11353, -0.05826, -0.000931, -0.182976, 0.095299, 0.011588, 0.081224, 0.041808, -0.114242, 0.050847, 0.000613, -0.025367, 0.104747, -0.019483, -0.044524, 0.014938, -0.020598, 0.074194, 0.143272, -0.090134, 0.024378, 0.016504, 0.073597, -0.000753, 0.014563, -0.086061, -0.097182, -0.176203, 0.091886, -0.090757, -0.057736, 0.070559, -0.00314, -0.208355, 0.07014, -0.089793, 0.102981, -0.055766, 0.080064, -0.171543, 0.084593, -0.021262, -0.070932, 0.094243, 0.094618, -0.060624, -0.103646, 0.016896, -0.022969, -0.06224, 0.083993, 0.050859, 0.170461, -0.040692, -0.231475, -0.054997, -0.139666, -0.182166, -0.154107, -0.103189, -0.191087, 0.114531, 0.107967, 0.049184, -0.003082, -0.130202, 0.236282, 0.037841, -0.041989, 0.095108, -8.8e-05, 0.004326, 0.030816, -0.018787, -0.009449, -0.073514, 0.034427, -0.075651, -0.108221, -0.147075, -0.088895, -0.102027, -0.058871, -0.156666, -0.099688, 0.020397, -0.086153, -0.046413, 0.066968]  \n","3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                [0.003752, -0.061771, -0.037073, 0.02677, -0.090658, 0.012813, -0.092285, 0.074664, -0.066141, 0.035619, 0.001939, 0.118046, 0.106249, -0.11127, -0.00702, 0.034989, 0.029654, 0.008367, -0.050007, -0.030704, -0.065894, 0.08123, -0.04539, -0.040012, 0.090774, 0.067699, -0.028125, -0.026579, -0.079355, 0.059613, 0.020613, 0.042591, 0.009983, -0.037203, 0.038242, -0.09384, -0.154576, -0.004471, -0.140145, -0.110083, 0.083281, 0.048921, 0.051276, 0.108326, 0.007419, -0.085701, -0.047435, 0.114793, -0.048882, -0.002836, 0.038695, -0.034756, -0.000584, 0.052104, -0.003848, 0.034386, 0.05696, -0.023321, -0.03635, -0.004535, 0.006874, 0.076202, -0.050935, 0.000466, -0.039141, -0.017551, -0.077054, -0.000394, -0.054463, -0.058872, -0.053088, 0.023609, 0.09061, 0.046973, -0.114502, -0.05578, -0.056306, 0.013576, -0.008754, 0.129473, 0.010713, 0.107132, 0.053372, 0.049199, 0.025105, -0.046849, -0.022099, -0.007698, 0.069537, -0.060824, -0.007802, 0.051335, 0.028594, -0.113466, -0.007955, -0.051726, 0.01268, -0.058242, -0.035847, 0.010902]  \n","4                                                                                                                                                                                                                                                      [-0.002881, 0.004461749999999999, 0.0216455, -0.0319155, 0.01663025, 0.010054749999999998, -0.01916075, -0.021661, -0.01865675, 0.05306275, 0.05101875, 0.005004500000000002, 0.032266249999999996, -0.007904750000000002, -0.029127, 0.0254845, 0.0004097499999999995, -0.0067407499999999985, -0.013089, -0.0030437500000000004, -0.015913, -0.0433275, 0.011350749999999998, 0.0525345, -0.0008897500000000008, 0.02573975, -0.007651999999999997, -0.00929225, 0.0448065, 0.018117, -0.0359185, 0.03973525, -0.00552225, -0.008944, 0.01508225, -0.016991250000000003, 0.01503075, -0.0601835, -0.01010925, -0.02391925, -0.0075657499999999996, 0.028589999999999997, 0.002065249999999999, 0.031218000000000003, -0.0029339999999999995, -0.0020675, 0.022651249999999998, 0.0024807500000000003, -0.00855425, 0.0010757499999999999, -0.0507135, 0.04121725, -0.0025839999999999995, 0.03242725, 0.0178115, 0.028885249999999994, 0.0324305, 0.0028447499999999983, -0.0030939999999999995, -0.0057535, -0.05343825000000001, 0.0381715, 0.004730500000000004, 0.014446249999999999, 0.0025997500000000014, -0.04085825, -0.05733099999999999, -0.002074000000000001, 0.0099355, -0.007765749999999998, 0.016694999999999998, -0.03809125, -0.0006677500000000017, 0.03310325, -0.0072145, -0.009807249999999998, -0.06560475, 0.025306500000000003, 0.043265, 0.0157745, -0.01787275, 0.01142425, 0.0043125, 0.008035500000000001, 0.01093525, -0.06853875, 0.012272749999999999, -0.00288825, 0.018862249999999997, -0.032462000000000005, -0.025650000000000006, 0.0008900000000000002, -0.033017, -0.041723750000000004, 0.022862, -0.0597975, 0.030372500000000004, -0.070557, 0.03394275, 0.026708749999999996]  "],"text/html":["\n","  <div id=\"df-e226ba15-54b0-4f8c-9841-15583a9d80b2\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>News ID</th>\n","      <th>Category</th>\n","      <th>SubCategory</th>\n","      <th>Title</th>\n","      <th>Abstract</th>\n","      <th>Content</th>\n","      <th>Content_WC</th>\n","      <th>Average Vector</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>N55528</td>\n","      <td>lifestyle</td>\n","      <td>lifestyle royals</td>\n","      <td>the brands queen elizabeth, prince charles, and prince philip swear by</td>\n","      <td>shop the notebooks, jackets, and more that the royals can't live without.</td>\n","      <td>lifestyle lifestyle royals the brands queen elizabeth prince charles and prince philip swear by shop the notebooks jackets and more that the royals cant live without</td>\n","      <td>26</td>\n","      <td>[0.004057333333333334, -0.03991733333333333, -0.008374, 0.07914233333333333, -0.020229666666666663, -0.022213, 0.040847666666666664, 0.0014350000000000005, 0.061828666666666664, -0.031631, 0.023040333333333333, 0.04310766666666666, 0.023592, -0.061693, 0.015099000000000001, -0.07910833333333334, 0.028382666666666667, 0.10652766666666667, -0.008534333333333333, -0.01902066666666667, 0.011596, -0.092748, 0.07943733333333333, -0.08211, -0.07028966666666668, -0.10451899999999999, 0.011144333333333334, -0.009591, 0.04464566666666667, -0.081025, -0.06339066666666666, -0.020261666666666667, 0.08129033333333334, 0.031477333333333336, -0.07450066666666667, 0.012981, -0.003404666666666667, 0.010823333333333332, -0.065875, 0.017982, -0.055929666666666676, 0.08072766666666667, -0.07246833333333333, 0.025115, -0.11045533333333334, 0.041048, -0.011876000000000003, -0.00434, -0.002706999999999999, -0.001977333333333333, 0.022897666666666667, 0.066106, 0.010144333333333333, 0.04570766666666667, 0.044172333333333334, 0.07795266666666667, 0.014355333333333331, 0.07450999999999999, -0.038349666666666664, -0.011252666666666666, 0.09210466666666665, -0.07734766666666666, 0.035256, -0.05846233333333334, 0.061819000000000006, 0.08261533333333333, 0.029722666666666665, 0.029845999999999998, -0.035560666666666664, 0.05244833333333334, -0.004362, 0.02662, -0.05474266666666666, 0.0003316666666666653, -0.019636666666666667, -0.004569333333333334, 0.03388133333333333, -0.021329333333333336, 0.0013953333333333328, 0.082415, 0.06908733333333333, -0.011366000000000001, -0.0005483333333333335, 0.013892, -0.011874000000000001, -0.063751, 0.076371, 0.03708566666666667, -0.001979999999999999, -0.027107666666666665, -0.073342, 0.014615999999999999, 0.05578533333333333, 0.024075666666666672, 0.026349333333333332, -0.05218166666666666, 0.046934, -0.024919666666666663, 0.07169866666666667, -0.03612766666666667]</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>N19639</td>\n","      <td>health</td>\n","      <td>weight loss</td>\n","      <td>50 worst habits for belly fat</td>\n","      <td>these seemingly harmless habits are holding you back and keeping you from shedding that unwanted belly fat for good.</td>\n","      <td>health weight loss 50 worst habits for belly fat these seemingly harmless habits are holding you back and keeping you from shedding that unwanted belly fat for good</td>\n","      <td>28</td>\n","      <td>[-0.013597, -0.009758, 0.01712, -0.051993, 0.037963, 0.045238, 0.077176, -0.033402, 0.032126, 0.000231, -0.041168, 0.006686, -0.042137, 0.003012, -0.007492, 0.004021, -0.044446, 0.060362, 0.036527, 0.000915, -0.0881, 0.013638, 0.00664, 0.023534, -0.006483, -0.030089, -0.01769, -0.076201, 0.010523, -0.015482, -0.029464, -0.000577, 0.011122, 0.020931, 0.019831, -0.020024, 0.046285, -0.087435, -0.014035, -0.032755, 0.000882, 0.058146, -0.063754, -0.01612, -0.028519, -0.006055, 0.043857, 0.012439, 0.008123, 0.068035, -0.025732, -0.082524, 0.012157, 0.005102, 0.050669, -0.029057, -0.097563, 0.01637, 0.104147, -0.013962, -0.085338, 0.002964, 0.002371, 0.033141, -0.094885, -0.041572, -0.083391, -0.017752, -0.021868, 0.003052, 0.065026, 0.018371, -0.009355, 0.078348, 0.028948, -0.043366, 0.007608, 0.031137, 0.054513, 0.030671, -0.021131, -0.048048, -0.013872, -0.000741, -0.059595, -0.109701, 0.046302, 0.016114, 0.05821, -0.015325, -0.085929, -0.059981, 0.004588, -0.028985, -0.059973, -0.035562, 0.106053, -0.10042, 0.051723, 0.001144]</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>N61837</td>\n","      <td>news</td>\n","      <td>news world</td>\n","      <td>the cost of trump's aid freeze in the trenches of ukraine's war</td>\n","      <td>lt. ivan molchanets peeked over a parapet of sand bags at the front line of the war in ukraine. next to him was an empty helmet propped up to trick snipers, already perforated with multiple holes.</td>\n","      <td>news news world the cost of trumps aid freeze in the trenches of ukraines war lt ivan molchanets peeked over a parapet of sand bags at the front line of the war in ukraine next to him was an empty helmet propped up to trick snipers already perforated with multiple holes</td>\n","      <td>51</td>\n","      <td>[-0.065324, -0.088163, -0.015203, -0.031949, 0.091263, -0.228807, -0.005629, -0.199308, 0.158042, 0.157506, 0.112573, 0.11353, -0.05826, -0.000931, -0.182976, 0.095299, 0.011588, 0.081224, 0.041808, -0.114242, 0.050847, 0.000613, -0.025367, 0.104747, -0.019483, -0.044524, 0.014938, -0.020598, 0.074194, 0.143272, -0.090134, 0.024378, 0.016504, 0.073597, -0.000753, 0.014563, -0.086061, -0.097182, -0.176203, 0.091886, -0.090757, -0.057736, 0.070559, -0.00314, -0.208355, 0.07014, -0.089793, 0.102981, -0.055766, 0.080064, -0.171543, 0.084593, -0.021262, -0.070932, 0.094243, 0.094618, -0.060624, -0.103646, 0.016896, -0.022969, -0.06224, 0.083993, 0.050859, 0.170461, -0.040692, -0.231475, -0.054997, -0.139666, -0.182166, -0.154107, -0.103189, -0.191087, 0.114531, 0.107967, 0.049184, -0.003082, -0.130202, 0.236282, 0.037841, -0.041989, 0.095108, -8.8e-05, 0.004326, 0.030816, -0.018787, -0.009449, -0.073514, 0.034427, -0.075651, -0.108221, -0.147075, -0.088895, -0.102027, -0.058871, -0.156666, -0.099688, 0.020397, -0.086153, -0.046413, 0.066968]</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>N53526</td>\n","      <td>health</td>\n","      <td>voices</td>\n","      <td>i was an nba wife. here's how it affected my mental health.</td>\n","      <td>i felt like i was a fraud, and being an nba wife didn't help that. in fact, it nearly destroyed me.</td>\n","      <td>health voices i was an nba wife heres how it affected my mental health i felt like i was a fraud and being an nba wife didnt help that in fact it nearly destroyed me</td>\n","      <td>35</td>\n","      <td>[0.003752, -0.061771, -0.037073, 0.02677, -0.090658, 0.012813, -0.092285, 0.074664, -0.066141, 0.035619, 0.001939, 0.118046, 0.106249, -0.11127, -0.00702, 0.034989, 0.029654, 0.008367, -0.050007, -0.030704, -0.065894, 0.08123, -0.04539, -0.040012, 0.090774, 0.067699, -0.028125, -0.026579, -0.079355, 0.059613, 0.020613, 0.042591, 0.009983, -0.037203, 0.038242, -0.09384, -0.154576, -0.004471, -0.140145, -0.110083, 0.083281, 0.048921, 0.051276, 0.108326, 0.007419, -0.085701, -0.047435, 0.114793, -0.048882, -0.002836, 0.038695, -0.034756, -0.000584, 0.052104, -0.003848, 0.034386, 0.05696, -0.023321, -0.03635, -0.004535, 0.006874, 0.076202, -0.050935, 0.000466, -0.039141, -0.017551, -0.077054, -0.000394, -0.054463, -0.058872, -0.053088, 0.023609, 0.09061, 0.046973, -0.114502, -0.05578, -0.056306, 0.013576, -0.008754, 0.129473, 0.010713, 0.107132, 0.053372, 0.049199, 0.025105, -0.046849, -0.022099, -0.007698, 0.069537, -0.060824, -0.007802, 0.051335, 0.028594, -0.113466, -0.007955, -0.051726, 0.01268, -0.058242, -0.035847, 0.010902]</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>N38324</td>\n","      <td>health</td>\n","      <td>medical</td>\n","      <td>how to get rid of skin tags, according to a dermatologist</td>\n","      <td>they seem harmless, but there's a very good reason you shouldn't ignore them. the post how to get rid of skin tags, according to a dermatologist appeared first on reader's digest.</td>\n","      <td>health medical how to get rid of skin tags according to a dermatologist they seem harmless but theres a very good reason you shouldnt ignore them the post how to get rid of skin tags according to a dermatologist appeared first on readers digest</td>\n","      <td>44</td>\n","      <td>[-0.002881, 0.004461749999999999, 0.0216455, -0.0319155, 0.01663025, 0.010054749999999998, -0.01916075, -0.021661, -0.01865675, 0.05306275, 0.05101875, 0.005004500000000002, 0.032266249999999996, -0.007904750000000002, -0.029127, 0.0254845, 0.0004097499999999995, -0.0067407499999999985, -0.013089, -0.0030437500000000004, -0.015913, -0.0433275, 0.011350749999999998, 0.0525345, -0.0008897500000000008, 0.02573975, -0.007651999999999997, -0.00929225, 0.0448065, 0.018117, -0.0359185, 0.03973525, -0.00552225, -0.008944, 0.01508225, -0.016991250000000003, 0.01503075, -0.0601835, -0.01010925, -0.02391925, -0.0075657499999999996, 0.028589999999999997, 0.002065249999999999, 0.031218000000000003, -0.0029339999999999995, -0.0020675, 0.022651249999999998, 0.0024807500000000003, -0.00855425, 0.0010757499999999999, -0.0507135, 0.04121725, -0.0025839999999999995, 0.03242725, 0.0178115, 0.028885249999999994, 0.0324305, 0.0028447499999999983, -0.0030939999999999995, -0.0057535, -0.05343825000000001, 0.0381715, 0.004730500000000004, 0.014446249999999999, 0.0025997500000000014, -0.04085825, -0.05733099999999999, -0.002074000000000001, 0.0099355, -0.007765749999999998, 0.016694999999999998, -0.03809125, -0.0006677500000000017, 0.03310325, -0.0072145, -0.009807249999999998, -0.06560475, 0.025306500000000003, 0.043265, 0.0157745, -0.01787275, 0.01142425, 0.0043125, 0.008035500000000001, 0.01093525, -0.06853875, 0.012272749999999999, -0.00288825, 0.018862249999999997, -0.032462000000000005, -0.025650000000000006, 0.0008900000000000002, -0.033017, -0.041723750000000004, 0.022862, -0.0597975, 0.030372500000000004, -0.070557, 0.03394275, 0.026708749999999996]</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-e226ba15-54b0-4f8c-9841-15583a9d80b2')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-e226ba15-54b0-4f8c-9841-15583a9d80b2 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-e226ba15-54b0-4f8c-9841-15583a9d80b2');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":160}]},{"cell_type":"markdown","metadata":{"id":"AXf-_G_aRZam"},"source":["### Export Clean News"]},{"cell_type":"code","source":["news.to_pickle(f\"/content/drive/MyDrive/Group_19/01.Dataset/{size}/Clean/{version}/news.pkl\")"],"metadata":{"id":"LW4lqNurK9Za"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9HYenULIRgoh"},"outputs":[],"source":["news.to_csv(f\"/content/drive/MyDrive/Group_19/01.Dataset/{size}/Clean/{version}/news.csv\")"]},{"cell_type":"markdown","metadata":{"id":"BYQpGFKLP56x"},"source":["## Clean Behaviors Dataset"]},{"cell_type":"markdown","source":["### Visualize Input Dataset"],"metadata":{"id":"ZMdVv70GJ1Ob"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"OBULdHCK97ub"},"outputs":[],"source":["behaviors = pd.read_csv(f\"/content/drive/MyDrive/Group_19/01.Dataset/{size}/Original/{version}/behaviors.tsv\",header=None,sep='\\t',names=['Impression ID', 'User ID', 'Timestamp', 'History', 'Impressions'], usecols=['User ID', 'Timestamp', 'History', 'Impressions'])"]},{"cell_type":"code","source":["behaviors.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"WTETxMWEy4V2","executionInfo":{"status":"ok","timestamp":1688054658756,"user_tz":-120,"elapsed":30,"user":{"displayName":"Vasco Oliveira","userId":"01429743951160621812"}},"outputId":"5d4026c1-3c0b-424d-b85d-9b094fb8b531"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["  User ID              Timestamp  \\\n","0  U13740  11/11/2019 9:05:58 AM   \n","1  U91836  11/12/2019 6:11:30 PM   \n","2  U73700  11/14/2019 7:01:48 AM   \n","3  U34670  11/11/2019 5:28:05 AM   \n","4   U8125  11/12/2019 4:11:21 PM   \n","\n","                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         History  \\\n","0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 N55189 N42782 N34694 N45794 N18445 N63302 N10414 N19347 N31801   \n","1  N31739 N6072 N63045 N23979 N35656 N43353 N8129 N1569 N17686 N13008 N21623 N6233 N14340 N48031 N62285 N44383 N23061 N16290 N6244 N45099 N58715 N59049 N7023 N50528 N42704 N46082 N8275 N15710 N59026 N8429 N30867 N56514 N19709 N31402 N31741 N54889 N9798 N62612 N2663 N16617 N6087 N13231 N63317 N61388 N59359 N51163 N30698 N34567 N54225 N32852 N55833 N64467 N3142 N13912 N29802 N44462 N29948 N4486 N5398 N14761 N47020 N65112 N31699 N37159 N61101 N14761 N3433 N10438 N61355 N21164 N22976 N2511 N48390 N58224 N48742 N35458 N24611 N37509 N21773 N41011 N19041 N25785   \n","2                                                                                                                                                                                                                                                                                                                                                                                                                                                                  N10732 N25792 N7563 N21087 N41087 N5445 N60384 N46616 N52500 N33164 N47289 N24233 N62058 N26378 N49475 N18870   \n","3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             N45729 N2203 N871 N53880 N41375 N43142 N33013 N29757 N31825 N51891   \n","4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    N10078 N56514 N14904 N33740   \n","\n","                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Impressions  \n","0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               N55689-1 N35729-0  \n","1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                N20678-0 N39317-0 N58114-0 N20495-0 N42977-0 N22407-0 N14592-0 N17059-1 N33677-0 N7821-0 N6890-0  \n","2                                                                                                                                                                                                                                                                                                N50014-0 N23877-0 N35389-0 N49712-0 N16844-0 N59685-0 N23814-1 N23446-0 N64174-0 N11817-0 N60550-0 N48225-0 N45509-0 N56711-0 N46821-0 N48017-0 N8015-0 N5364-0 N48722-0 N55555-0 N37348-0 N40109-0 N59495-0 N36226-0 N38779-0 N47346-0 N48875-0 N10960-0 N29739-0 N50872-0 N50592-0 N13131-0 N3839-0 N12330-0 N47098-0 N51570-0  \n","3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             N35729-0 N33632-0 N49685-1 N27581-0  \n","4  N39985-0 N36050-0 N16096-0 N8400-1 N22407-0 N60408-0 N61497-0 N47412-0 N41220-0 N1940-0 N724-0 N11363-0 N261-0 N33883-0 N36807-0 N11967-0 N17896-0 N13486-0 N10413-0 N54274-0 N4247-0 N27497-0 N38512-0 N30253-0 N45389-0 N20015-0 N20678-0 N54003-0 N35850-0 N33261-0 N32010-0 N57426-0 N7419-0 N50023-0 N36446-0 N26940-0 N28495-0 N19318-0 N4936-0 N28414-0 N25108-0 N32791-0 N23563-0 N39317-0 N16166-0 N37058-0 N64851-0 N46992-0 N57327-0 N12995-0 N58363-0 N53084-0 N11094-0 N36436-0 N305-0 N58241-0 N33212-0 N6975-0 N58114-0 N3344-0 N25406-0 N4741-0 N33885-0 N20915-0 N44941-0 N57319-0 N36532-0 N61822-0 N20527-0  "],"text/html":["\n","  <div id=\"df-7e82e49d-b931-485d-b19b-3bed135eb98d\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>User ID</th>\n","      <th>Timestamp</th>\n","      <th>History</th>\n","      <th>Impressions</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>U13740</td>\n","      <td>11/11/2019 9:05:58 AM</td>\n","      <td>N55189 N42782 N34694 N45794 N18445 N63302 N10414 N19347 N31801</td>\n","      <td>N55689-1 N35729-0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>U91836</td>\n","      <td>11/12/2019 6:11:30 PM</td>\n","      <td>N31739 N6072 N63045 N23979 N35656 N43353 N8129 N1569 N17686 N13008 N21623 N6233 N14340 N48031 N62285 N44383 N23061 N16290 N6244 N45099 N58715 N59049 N7023 N50528 N42704 N46082 N8275 N15710 N59026 N8429 N30867 N56514 N19709 N31402 N31741 N54889 N9798 N62612 N2663 N16617 N6087 N13231 N63317 N61388 N59359 N51163 N30698 N34567 N54225 N32852 N55833 N64467 N3142 N13912 N29802 N44462 N29948 N4486 N5398 N14761 N47020 N65112 N31699 N37159 N61101 N14761 N3433 N10438 N61355 N21164 N22976 N2511 N48390 N58224 N48742 N35458 N24611 N37509 N21773 N41011 N19041 N25785</td>\n","      <td>N20678-0 N39317-0 N58114-0 N20495-0 N42977-0 N22407-0 N14592-0 N17059-1 N33677-0 N7821-0 N6890-0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>U73700</td>\n","      <td>11/14/2019 7:01:48 AM</td>\n","      <td>N10732 N25792 N7563 N21087 N41087 N5445 N60384 N46616 N52500 N33164 N47289 N24233 N62058 N26378 N49475 N18870</td>\n","      <td>N50014-0 N23877-0 N35389-0 N49712-0 N16844-0 N59685-0 N23814-1 N23446-0 N64174-0 N11817-0 N60550-0 N48225-0 N45509-0 N56711-0 N46821-0 N48017-0 N8015-0 N5364-0 N48722-0 N55555-0 N37348-0 N40109-0 N59495-0 N36226-0 N38779-0 N47346-0 N48875-0 N10960-0 N29739-0 N50872-0 N50592-0 N13131-0 N3839-0 N12330-0 N47098-0 N51570-0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>U34670</td>\n","      <td>11/11/2019 5:28:05 AM</td>\n","      <td>N45729 N2203 N871 N53880 N41375 N43142 N33013 N29757 N31825 N51891</td>\n","      <td>N35729-0 N33632-0 N49685-1 N27581-0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>U8125</td>\n","      <td>11/12/2019 4:11:21 PM</td>\n","      <td>N10078 N56514 N14904 N33740</td>\n","      <td>N39985-0 N36050-0 N16096-0 N8400-1 N22407-0 N60408-0 N61497-0 N47412-0 N41220-0 N1940-0 N724-0 N11363-0 N261-0 N33883-0 N36807-0 N11967-0 N17896-0 N13486-0 N10413-0 N54274-0 N4247-0 N27497-0 N38512-0 N30253-0 N45389-0 N20015-0 N20678-0 N54003-0 N35850-0 N33261-0 N32010-0 N57426-0 N7419-0 N50023-0 N36446-0 N26940-0 N28495-0 N19318-0 N4936-0 N28414-0 N25108-0 N32791-0 N23563-0 N39317-0 N16166-0 N37058-0 N64851-0 N46992-0 N57327-0 N12995-0 N58363-0 N53084-0 N11094-0 N36436-0 N305-0 N58241-0 N33212-0 N6975-0 N58114-0 N3344-0 N25406-0 N4741-0 N33885-0 N20915-0 N44941-0 N57319-0 N36532-0 N61822-0 N20527-0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7e82e49d-b931-485d-b19b-3bed135eb98d')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-7e82e49d-b931-485d-b19b-3bed135eb98d button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-7e82e49d-b931-485d-b19b-3bed135eb98d');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":164}]},{"cell_type":"code","source":["news = pd.read_pickle(f\"/content/drive/MyDrive/Group_19/01.Dataset/{size}/Clean/{version}/news.pkl\")"],"metadata":{"id":"dIAuJp2t3L7q"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["news.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"JIukMKK-3LxK","executionInfo":{"status":"ok","timestamp":1688054659472,"user_tz":-120,"elapsed":20,"user":{"displayName":"Vasco Oliveira","userId":"01429743951160621812"}},"outputId":"28ca18b6-c210-4e91-e2ed-1c1bc71e04c6"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["  News ID   Category       SubCategory  \\\n","0  N55528  lifestyle  lifestyle royals   \n","1  N19639     health       weight loss   \n","2  N61837       news        news world   \n","3  N53526     health            voices   \n","4  N38324     health           medical   \n","\n","                                                                    Title  \\\n","0  the brands queen elizabeth, prince charles, and prince philip swear by   \n","1                                           50 worst habits for belly fat   \n","2         the cost of trump's aid freeze in the trenches of ukraine's war   \n","3             i was an nba wife. here's how it affected my mental health.   \n","4               how to get rid of skin tags, according to a dermatologist   \n","\n","                                                                                                                                                                                               Abstract  \\\n","0                                                                                                                             shop the notebooks, jackets, and more that the royals can't live without.   \n","1                                                                                  these seemingly harmless habits are holding you back and keeping you from shedding that unwanted belly fat for good.   \n","2  lt. ivan molchanets peeked over a parapet of sand bags at the front line of the war in ukraine. next to him was an empty helmet propped up to trick snipers, already perforated with multiple holes.   \n","3                                                                                                   i felt like i was a fraud, and being an nba wife didn't help that. in fact, it nearly destroyed me.   \n","4                   they seem harmless, but there's a very good reason you shouldn't ignore them. the post how to get rid of skin tags, according to a dermatologist appeared first on reader's digest.   \n","\n","                                                                                                                                                                                                                                                                          Content  \\\n","0                                                                                                           lifestyle lifestyle royals the brands queen elizabeth prince charles and prince philip swear by shop the notebooks jackets and more that the royals cant live without   \n","1                                                                                                            health weight loss 50 worst habits for belly fat these seemingly harmless habits are holding you back and keeping you from shedding that unwanted belly fat for good   \n","2  news news world the cost of trumps aid freeze in the trenches of ukraines war lt ivan molchanets peeked over a parapet of sand bags at the front line of the war in ukraine next to him was an empty helmet propped up to trick snipers already perforated with multiple holes   \n","3                                                                                                           health voices i was an nba wife heres how it affected my mental health i felt like i was a fraud and being an nba wife didnt help that in fact it nearly destroyed me   \n","4                            health medical how to get rid of skin tags according to a dermatologist they seem harmless but theres a very good reason you shouldnt ignore them the post how to get rid of skin tags according to a dermatologist appeared first on readers digest   \n","\n","   Content_WC  \\\n","0          26   \n","1          28   \n","2          51   \n","3          35   \n","4          44   \n","\n","                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Average Vector  \n","0  [0.004057333333333334, -0.03991733333333333, -0.008374, 0.07914233333333333, -0.020229666666666663, -0.022213, 0.040847666666666664, 0.0014350000000000005, 0.061828666666666664, -0.031631, 0.023040333333333333, 0.04310766666666666, 0.023592, -0.061693, 0.015099000000000001, -0.07910833333333334, 0.028382666666666667, 0.10652766666666667, -0.008534333333333333, -0.01902066666666667, 0.011596, -0.092748, 0.07943733333333333, -0.08211, -0.07028966666666668, -0.10451899999999999, 0.011144333333333334, -0.009591, 0.04464566666666667, -0.081025, -0.06339066666666666, -0.020261666666666667, 0.08129033333333334, 0.031477333333333336, -0.07450066666666667, 0.012981, -0.003404666666666667, 0.010823333333333332, -0.065875, 0.017982, -0.055929666666666676, 0.08072766666666667, -0.07246833333333333, 0.025115, -0.11045533333333334, 0.041048, -0.011876000000000003, -0.00434, -0.002706999999999999, -0.001977333333333333, 0.022897666666666667, 0.066106, 0.010144333333333333, 0.04570766666666667, 0.044172333333333334, 0.07795266666666667, 0.014355333333333331, 0.07450999999999999, -0.038349666666666664, -0.011252666666666666, 0.09210466666666665, -0.07734766666666666, 0.035256, -0.05846233333333334, 0.061819000000000006, 0.08261533333333333, 0.029722666666666665, 0.029845999999999998, -0.035560666666666664, 0.05244833333333334, -0.004362, 0.02662, -0.05474266666666666, 0.0003316666666666653, -0.019636666666666667, -0.004569333333333334, 0.03388133333333333, -0.021329333333333336, 0.0013953333333333328, 0.082415, 0.06908733333333333, -0.011366000000000001, -0.0005483333333333335, 0.013892, -0.011874000000000001, -0.063751, 0.076371, 0.03708566666666667, -0.001979999999999999, -0.027107666666666665, -0.073342, 0.014615999999999999, 0.05578533333333333, 0.024075666666666672, 0.026349333333333332, -0.05218166666666666, 0.046934, -0.024919666666666663, 0.07169866666666667, -0.03612766666666667]  \n","1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 [-0.013597, -0.009758, 0.01712, -0.051993, 0.037963, 0.045238, 0.077176, -0.033402, 0.032126, 0.000231, -0.041168, 0.006686, -0.042137, 0.003012, -0.007492, 0.004021, -0.044446, 0.060362, 0.036527, 0.000915, -0.0881, 0.013638, 0.00664, 0.023534, -0.006483, -0.030089, -0.01769, -0.076201, 0.010523, -0.015482, -0.029464, -0.000577, 0.011122, 0.020931, 0.019831, -0.020024, 0.046285, -0.087435, -0.014035, -0.032755, 0.000882, 0.058146, -0.063754, -0.01612, -0.028519, -0.006055, 0.043857, 0.012439, 0.008123, 0.068035, -0.025732, -0.082524, 0.012157, 0.005102, 0.050669, -0.029057, -0.097563, 0.01637, 0.104147, -0.013962, -0.085338, 0.002964, 0.002371, 0.033141, -0.094885, -0.041572, -0.083391, -0.017752, -0.021868, 0.003052, 0.065026, 0.018371, -0.009355, 0.078348, 0.028948, -0.043366, 0.007608, 0.031137, 0.054513, 0.030671, -0.021131, -0.048048, -0.013872, -0.000741, -0.059595, -0.109701, 0.046302, 0.016114, 0.05821, -0.015325, -0.085929, -0.059981, 0.004588, -0.028985, -0.059973, -0.035562, 0.106053, -0.10042, 0.051723, 0.001144]  \n","2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      [-0.065324, -0.088163, -0.015203, -0.031949, 0.091263, -0.228807, -0.005629, -0.199308, 0.158042, 0.157506, 0.112573, 0.11353, -0.05826, -0.000931, -0.182976, 0.095299, 0.011588, 0.081224, 0.041808, -0.114242, 0.050847, 0.000613, -0.025367, 0.104747, -0.019483, -0.044524, 0.014938, -0.020598, 0.074194, 0.143272, -0.090134, 0.024378, 0.016504, 0.073597, -0.000753, 0.014563, -0.086061, -0.097182, -0.176203, 0.091886, -0.090757, -0.057736, 0.070559, -0.00314, -0.208355, 0.07014, -0.089793, 0.102981, -0.055766, 0.080064, -0.171543, 0.084593, -0.021262, -0.070932, 0.094243, 0.094618, -0.060624, -0.103646, 0.016896, -0.022969, -0.06224, 0.083993, 0.050859, 0.170461, -0.040692, -0.231475, -0.054997, -0.139666, -0.182166, -0.154107, -0.103189, -0.191087, 0.114531, 0.107967, 0.049184, -0.003082, -0.130202, 0.236282, 0.037841, -0.041989, 0.095108, -8.8e-05, 0.004326, 0.030816, -0.018787, -0.009449, -0.073514, 0.034427, -0.075651, -0.108221, -0.147075, -0.088895, -0.102027, -0.058871, -0.156666, -0.099688, 0.020397, -0.086153, -0.046413, 0.066968]  \n","3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                [0.003752, -0.061771, -0.037073, 0.02677, -0.090658, 0.012813, -0.092285, 0.074664, -0.066141, 0.035619, 0.001939, 0.118046, 0.106249, -0.11127, -0.00702, 0.034989, 0.029654, 0.008367, -0.050007, -0.030704, -0.065894, 0.08123, -0.04539, -0.040012, 0.090774, 0.067699, -0.028125, -0.026579, -0.079355, 0.059613, 0.020613, 0.042591, 0.009983, -0.037203, 0.038242, -0.09384, -0.154576, -0.004471, -0.140145, -0.110083, 0.083281, 0.048921, 0.051276, 0.108326, 0.007419, -0.085701, -0.047435, 0.114793, -0.048882, -0.002836, 0.038695, -0.034756, -0.000584, 0.052104, -0.003848, 0.034386, 0.05696, -0.023321, -0.03635, -0.004535, 0.006874, 0.076202, -0.050935, 0.000466, -0.039141, -0.017551, -0.077054, -0.000394, -0.054463, -0.058872, -0.053088, 0.023609, 0.09061, 0.046973, -0.114502, -0.05578, -0.056306, 0.013576, -0.008754, 0.129473, 0.010713, 0.107132, 0.053372, 0.049199, 0.025105, -0.046849, -0.022099, -0.007698, 0.069537, -0.060824, -0.007802, 0.051335, 0.028594, -0.113466, -0.007955, -0.051726, 0.01268, -0.058242, -0.035847, 0.010902]  \n","4                                                                                                                                                                                                                                                      [-0.002881, 0.004461749999999999, 0.0216455, -0.0319155, 0.01663025, 0.010054749999999998, -0.01916075, -0.021661, -0.01865675, 0.05306275, 0.05101875, 0.005004500000000002, 0.032266249999999996, -0.007904750000000002, -0.029127, 0.0254845, 0.0004097499999999995, -0.0067407499999999985, -0.013089, -0.0030437500000000004, -0.015913, -0.0433275, 0.011350749999999998, 0.0525345, -0.0008897500000000008, 0.02573975, -0.007651999999999997, -0.00929225, 0.0448065, 0.018117, -0.0359185, 0.03973525, -0.00552225, -0.008944, 0.01508225, -0.016991250000000003, 0.01503075, -0.0601835, -0.01010925, -0.02391925, -0.0075657499999999996, 0.028589999999999997, 0.002065249999999999, 0.031218000000000003, -0.0029339999999999995, -0.0020675, 0.022651249999999998, 0.0024807500000000003, -0.00855425, 0.0010757499999999999, -0.0507135, 0.04121725, -0.0025839999999999995, 0.03242725, 0.0178115, 0.028885249999999994, 0.0324305, 0.0028447499999999983, -0.0030939999999999995, -0.0057535, -0.05343825000000001, 0.0381715, 0.004730500000000004, 0.014446249999999999, 0.0025997500000000014, -0.04085825, -0.05733099999999999, -0.002074000000000001, 0.0099355, -0.007765749999999998, 0.016694999999999998, -0.03809125, -0.0006677500000000017, 0.03310325, -0.0072145, -0.009807249999999998, -0.06560475, 0.025306500000000003, 0.043265, 0.0157745, -0.01787275, 0.01142425, 0.0043125, 0.008035500000000001, 0.01093525, -0.06853875, 0.012272749999999999, -0.00288825, 0.018862249999999997, -0.032462000000000005, -0.025650000000000006, 0.0008900000000000002, -0.033017, -0.041723750000000004, 0.022862, -0.0597975, 0.030372500000000004, -0.070557, 0.03394275, 0.026708749999999996]  "],"text/html":["\n","  <div id=\"df-c98e2051-a452-45ad-9b5f-543a32f3863e\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>News ID</th>\n","      <th>Category</th>\n","      <th>SubCategory</th>\n","      <th>Title</th>\n","      <th>Abstract</th>\n","      <th>Content</th>\n","      <th>Content_WC</th>\n","      <th>Average Vector</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>N55528</td>\n","      <td>lifestyle</td>\n","      <td>lifestyle royals</td>\n","      <td>the brands queen elizabeth, prince charles, and prince philip swear by</td>\n","      <td>shop the notebooks, jackets, and more that the royals can't live without.</td>\n","      <td>lifestyle lifestyle royals the brands queen elizabeth prince charles and prince philip swear by shop the notebooks jackets and more that the royals cant live without</td>\n","      <td>26</td>\n","      <td>[0.004057333333333334, -0.03991733333333333, -0.008374, 0.07914233333333333, -0.020229666666666663, -0.022213, 0.040847666666666664, 0.0014350000000000005, 0.061828666666666664, -0.031631, 0.023040333333333333, 0.04310766666666666, 0.023592, -0.061693, 0.015099000000000001, -0.07910833333333334, 0.028382666666666667, 0.10652766666666667, -0.008534333333333333, -0.01902066666666667, 0.011596, -0.092748, 0.07943733333333333, -0.08211, -0.07028966666666668, -0.10451899999999999, 0.011144333333333334, -0.009591, 0.04464566666666667, -0.081025, -0.06339066666666666, -0.020261666666666667, 0.08129033333333334, 0.031477333333333336, -0.07450066666666667, 0.012981, -0.003404666666666667, 0.010823333333333332, -0.065875, 0.017982, -0.055929666666666676, 0.08072766666666667, -0.07246833333333333, 0.025115, -0.11045533333333334, 0.041048, -0.011876000000000003, -0.00434, -0.002706999999999999, -0.001977333333333333, 0.022897666666666667, 0.066106, 0.010144333333333333, 0.04570766666666667, 0.044172333333333334, 0.07795266666666667, 0.014355333333333331, 0.07450999999999999, -0.038349666666666664, -0.011252666666666666, 0.09210466666666665, -0.07734766666666666, 0.035256, -0.05846233333333334, 0.061819000000000006, 0.08261533333333333, 0.029722666666666665, 0.029845999999999998, -0.035560666666666664, 0.05244833333333334, -0.004362, 0.02662, -0.05474266666666666, 0.0003316666666666653, -0.019636666666666667, -0.004569333333333334, 0.03388133333333333, -0.021329333333333336, 0.0013953333333333328, 0.082415, 0.06908733333333333, -0.011366000000000001, -0.0005483333333333335, 0.013892, -0.011874000000000001, -0.063751, 0.076371, 0.03708566666666667, -0.001979999999999999, -0.027107666666666665, -0.073342, 0.014615999999999999, 0.05578533333333333, 0.024075666666666672, 0.026349333333333332, -0.05218166666666666, 0.046934, -0.024919666666666663, 0.07169866666666667, -0.03612766666666667]</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>N19639</td>\n","      <td>health</td>\n","      <td>weight loss</td>\n","      <td>50 worst habits for belly fat</td>\n","      <td>these seemingly harmless habits are holding you back and keeping you from shedding that unwanted belly fat for good.</td>\n","      <td>health weight loss 50 worst habits for belly fat these seemingly harmless habits are holding you back and keeping you from shedding that unwanted belly fat for good</td>\n","      <td>28</td>\n","      <td>[-0.013597, -0.009758, 0.01712, -0.051993, 0.037963, 0.045238, 0.077176, -0.033402, 0.032126, 0.000231, -0.041168, 0.006686, -0.042137, 0.003012, -0.007492, 0.004021, -0.044446, 0.060362, 0.036527, 0.000915, -0.0881, 0.013638, 0.00664, 0.023534, -0.006483, -0.030089, -0.01769, -0.076201, 0.010523, -0.015482, -0.029464, -0.000577, 0.011122, 0.020931, 0.019831, -0.020024, 0.046285, -0.087435, -0.014035, -0.032755, 0.000882, 0.058146, -0.063754, -0.01612, -0.028519, -0.006055, 0.043857, 0.012439, 0.008123, 0.068035, -0.025732, -0.082524, 0.012157, 0.005102, 0.050669, -0.029057, -0.097563, 0.01637, 0.104147, -0.013962, -0.085338, 0.002964, 0.002371, 0.033141, -0.094885, -0.041572, -0.083391, -0.017752, -0.021868, 0.003052, 0.065026, 0.018371, -0.009355, 0.078348, 0.028948, -0.043366, 0.007608, 0.031137, 0.054513, 0.030671, -0.021131, -0.048048, -0.013872, -0.000741, -0.059595, -0.109701, 0.046302, 0.016114, 0.05821, -0.015325, -0.085929, -0.059981, 0.004588, -0.028985, -0.059973, -0.035562, 0.106053, -0.10042, 0.051723, 0.001144]</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>N61837</td>\n","      <td>news</td>\n","      <td>news world</td>\n","      <td>the cost of trump's aid freeze in the trenches of ukraine's war</td>\n","      <td>lt. ivan molchanets peeked over a parapet of sand bags at the front line of the war in ukraine. next to him was an empty helmet propped up to trick snipers, already perforated with multiple holes.</td>\n","      <td>news news world the cost of trumps aid freeze in the trenches of ukraines war lt ivan molchanets peeked over a parapet of sand bags at the front line of the war in ukraine next to him was an empty helmet propped up to trick snipers already perforated with multiple holes</td>\n","      <td>51</td>\n","      <td>[-0.065324, -0.088163, -0.015203, -0.031949, 0.091263, -0.228807, -0.005629, -0.199308, 0.158042, 0.157506, 0.112573, 0.11353, -0.05826, -0.000931, -0.182976, 0.095299, 0.011588, 0.081224, 0.041808, -0.114242, 0.050847, 0.000613, -0.025367, 0.104747, -0.019483, -0.044524, 0.014938, -0.020598, 0.074194, 0.143272, -0.090134, 0.024378, 0.016504, 0.073597, -0.000753, 0.014563, -0.086061, -0.097182, -0.176203, 0.091886, -0.090757, -0.057736, 0.070559, -0.00314, -0.208355, 0.07014, -0.089793, 0.102981, -0.055766, 0.080064, -0.171543, 0.084593, -0.021262, -0.070932, 0.094243, 0.094618, -0.060624, -0.103646, 0.016896, -0.022969, -0.06224, 0.083993, 0.050859, 0.170461, -0.040692, -0.231475, -0.054997, -0.139666, -0.182166, -0.154107, -0.103189, -0.191087, 0.114531, 0.107967, 0.049184, -0.003082, -0.130202, 0.236282, 0.037841, -0.041989, 0.095108, -8.8e-05, 0.004326, 0.030816, -0.018787, -0.009449, -0.073514, 0.034427, -0.075651, -0.108221, -0.147075, -0.088895, -0.102027, -0.058871, -0.156666, -0.099688, 0.020397, -0.086153, -0.046413, 0.066968]</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>N53526</td>\n","      <td>health</td>\n","      <td>voices</td>\n","      <td>i was an nba wife. here's how it affected my mental health.</td>\n","      <td>i felt like i was a fraud, and being an nba wife didn't help that. in fact, it nearly destroyed me.</td>\n","      <td>health voices i was an nba wife heres how it affected my mental health i felt like i was a fraud and being an nba wife didnt help that in fact it nearly destroyed me</td>\n","      <td>35</td>\n","      <td>[0.003752, -0.061771, -0.037073, 0.02677, -0.090658, 0.012813, -0.092285, 0.074664, -0.066141, 0.035619, 0.001939, 0.118046, 0.106249, -0.11127, -0.00702, 0.034989, 0.029654, 0.008367, -0.050007, -0.030704, -0.065894, 0.08123, -0.04539, -0.040012, 0.090774, 0.067699, -0.028125, -0.026579, -0.079355, 0.059613, 0.020613, 0.042591, 0.009983, -0.037203, 0.038242, -0.09384, -0.154576, -0.004471, -0.140145, -0.110083, 0.083281, 0.048921, 0.051276, 0.108326, 0.007419, -0.085701, -0.047435, 0.114793, -0.048882, -0.002836, 0.038695, -0.034756, -0.000584, 0.052104, -0.003848, 0.034386, 0.05696, -0.023321, -0.03635, -0.004535, 0.006874, 0.076202, -0.050935, 0.000466, -0.039141, -0.017551, -0.077054, -0.000394, -0.054463, -0.058872, -0.053088, 0.023609, 0.09061, 0.046973, -0.114502, -0.05578, -0.056306, 0.013576, -0.008754, 0.129473, 0.010713, 0.107132, 0.053372, 0.049199, 0.025105, -0.046849, -0.022099, -0.007698, 0.069537, -0.060824, -0.007802, 0.051335, 0.028594, -0.113466, -0.007955, -0.051726, 0.01268, -0.058242, -0.035847, 0.010902]</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>N38324</td>\n","      <td>health</td>\n","      <td>medical</td>\n","      <td>how to get rid of skin tags, according to a dermatologist</td>\n","      <td>they seem harmless, but there's a very good reason you shouldn't ignore them. the post how to get rid of skin tags, according to a dermatologist appeared first on reader's digest.</td>\n","      <td>health medical how to get rid of skin tags according to a dermatologist they seem harmless but theres a very good reason you shouldnt ignore them the post how to get rid of skin tags according to a dermatologist appeared first on readers digest</td>\n","      <td>44</td>\n","      <td>[-0.002881, 0.004461749999999999, 0.0216455, -0.0319155, 0.01663025, 0.010054749999999998, -0.01916075, -0.021661, -0.01865675, 0.05306275, 0.05101875, 0.005004500000000002, 0.032266249999999996, -0.007904750000000002, -0.029127, 0.0254845, 0.0004097499999999995, -0.0067407499999999985, -0.013089, -0.0030437500000000004, -0.015913, -0.0433275, 0.011350749999999998, 0.0525345, -0.0008897500000000008, 0.02573975, -0.007651999999999997, -0.00929225, 0.0448065, 0.018117, -0.0359185, 0.03973525, -0.00552225, -0.008944, 0.01508225, -0.016991250000000003, 0.01503075, -0.0601835, -0.01010925, -0.02391925, -0.0075657499999999996, 0.028589999999999997, 0.002065249999999999, 0.031218000000000003, -0.0029339999999999995, -0.0020675, 0.022651249999999998, 0.0024807500000000003, -0.00855425, 0.0010757499999999999, -0.0507135, 0.04121725, -0.0025839999999999995, 0.03242725, 0.0178115, 0.028885249999999994, 0.0324305, 0.0028447499999999983, -0.0030939999999999995, -0.0057535, -0.05343825000000001, 0.0381715, 0.004730500000000004, 0.014446249999999999, 0.0025997500000000014, -0.04085825, -0.05733099999999999, -0.002074000000000001, 0.0099355, -0.007765749999999998, 0.016694999999999998, -0.03809125, -0.0006677500000000017, 0.03310325, -0.0072145, -0.009807249999999998, -0.06560475, 0.025306500000000003, 0.043265, 0.0157745, -0.01787275, 0.01142425, 0.0043125, 0.008035500000000001, 0.01093525, -0.06853875, 0.012272749999999999, -0.00288825, 0.018862249999999997, -0.032462000000000005, -0.025650000000000006, 0.0008900000000000002, -0.033017, -0.041723750000000004, 0.022862, -0.0597975, 0.030372500000000004, -0.070557, 0.03394275, 0.026708749999999996]</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c98e2051-a452-45ad-9b5f-543a32f3863e')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-c98e2051-a452-45ad-9b5f-543a32f3863e button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-c98e2051-a452-45ad-9b5f-543a32f3863e');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":166}]},{"cell_type":"markdown","metadata":{"id":"YtqsVWD6HhwQ"},"source":["### Transformations"]},{"cell_type":"code","source":["def get_clean_behaviors(behaviors, news):\n","\n","  behaviors['Timestamp'] = pd.to_datetime(behaviors['Timestamp'])\n","\n","  # Remove unclicked articles, the impression indicator from read articles, and strip edges of spaces\n","  behaviors['Impressions'] = behaviors['Impressions'].str.replace(r'\\w+-0', '', regex=True).str.strip().str.replace('-1','')\n","\n","  # Edit history column\n","  behaviors['History'] = behaviors['History'].str.strip().astype(str)\n","\n","  # Remove duplicates from articles read\n","  def remove_duplicates(history):\n","    news_ids = history.split()\n","    unique_news_ids = ' '.join(list(set(news_ids)))\n","    return unique_news_ids\n","\n","  # Apply the remove_duplicates function to the 'text' column\n","  behaviors['History'] = behaviors['History'].apply(lambda x: remove_duplicates(x))\n","\n","  # Drop duplicate rows (Only 1)\n","  behaviors.drop_duplicates(inplace=True)\n","\n","  # Create a set of valid news IDs\n","  valid_news_ids = set(news['News ID'])\n","\n","  # Function to filter articles for articles present in news_df\n","  def filter_history(user_history):\n","      filtered_ids = [news_id for news_id in user_history.split() if news_id in valid_news_ids]\n","      return ' '.join(filtered_ids)\n","\n","  # Apply filtering function to user history column\n","  behaviors['History'] = behaviors['History'].apply(filter_history)\n","\n","  # Apply filtering function to user impressions column\n","  behaviors['Impressions'] = behaviors['Impressions'].apply(filter_history)\n","\n","  # Create column with both history & impressions\n","  behaviors['History & Impressions'] = behaviors['History'].str.strip().astype(str) + ' ' + behaviors['Impressions'].str.strip().astype(str)\n","\n","  behaviors['History & Impressions'] = behaviors['History & Impressions'].str.strip()\n","\n","  # Get History & Impressions article IDs into a list of sets\n","  user_articles = behaviors['History & Impressions'].str.split().apply(set)\n","\n","  # Create a dictionary mapping article IDs to average vectors\n","  average_vectors_dict = news.groupby('News ID')['Average Vector'].mean().to_dict()\n","\n","  # Create a function to calculate the average vector per row\n","  def calculate_average_vector(article_ids):\n","      vectors = [average_vectors_dict.get(article_id) for article_id in article_ids if article_id in average_vectors_dict]\n","      if vectors:\n","          return sum(vectors) / len(vectors)\n","      return None\n","\n","  # Apply the function to each row and assign the average vectors to the 'Average Vector' column\n","  behaviors['Average Vector'] = user_articles.apply(calculate_average_vector)\n","\n","  return behaviors"],"metadata":{"id":"85H9Bev81fQL"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Lr5y8RiqoWuF"},"outputs":[],"source":["behaviors = get_clean_behaviors(behaviors, news)"]},{"cell_type":"markdown","source":["### Export Transformed Pickle File"],"metadata":{"id":"0By8wevG2PaY"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"xhUI4pfB3itE"},"outputs":[],"source":["behaviors.to_pickle(f\"/content/drive/MyDrive/Group_19/01.Dataset/{size}/Clean/{version}/behaviors.pkl\")"]},{"cell_type":"markdown","metadata":{"id":"dFQnEX9Iux7J"},"source":["## Add Release Dates to News"]},{"cell_type":"markdown","source":["### Visualize Input Dataset"],"metadata":{"id":"Y_XaMmDCKCjx"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"P5bxl7tZtNYY"},"outputs":[],"source":["behaviors = pd.read_pickle(f\"/content/drive/MyDrive/Group_19/01.Dataset/{size}/Clean/{version}/behaviors.pkl\")"]},{"cell_type":"code","source":["behaviors.head()"],"metadata":{"id":"tck50nq80zBx","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1688054709489,"user_tz":-120,"elapsed":15,"user":{"displayName":"Vasco Oliveira","userId":"01429743951160621812"}},"outputId":"2c30f3cd-ddca-4948-e6e5-177c9ebaae35"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["  User ID           Timestamp  \\\n","0  U13740 2019-11-11 09:05:58   \n","1  U91836 2019-11-12 18:11:30   \n","2  U73700 2019-11-14 07:01:48   \n","3  U34670 2019-11-11 05:28:05   \n","4   U8125 2019-11-12 16:11:21   \n","\n","                                                                                                                                                                                                                                                                                                                                                                                                                                                           History  \\\n","0                                                                                                                                                                                                                                                                                                                                                                                                   N31801 N19347 N42782 N45794 N63302 N10414 N18445 N34694 N55189   \n","1  N43353 N31741 N21164 N59026 N61355 N32852 N59049 N46082 N2511 N21623 N9798 N37509 N8429 N30867 N58224 N6233 N47020 N6087 N13912 N6072 N64467 N16617 N24611 N63317 N58715 N34567 N54225 N61388 N61101 N8129 N51163 N7023 N44383 N13231 N14761 N2663 N65112 N4486 N1569 N29802 N16290 N63045 N31402 N3433 N13008 N30698 N48742 N23979 N62285 N35458 N56514 N10438 N41011 N14340 N59359 N23061 N31739 N31699 N37159 N44462 N22976 N19709 N54889 N29948 N3142 N8275   \n","2                                                                                                                                                                                                                                                                                                                                                    N26378 N52500 N47289 N62058 N5445 N41087 N18870 N21087 N49475 N7563 N60384 N46616 N33164 N10732 N24233 N25792   \n","3                                                                                                                                                                                                                                                                                                                                                                                               N29757 N43142 N41375 N871 N2203 N31825 N53880 N45729 N33013 N51891   \n","4                                                                                                                                                                                                                                                                                                                                                                                                                                      N10078 N14904 N33740 N56514   \n","\n","  Impressions  \\\n","0      N55689   \n","1      N17059   \n","2      N23814   \n","3      N49685   \n","4       N8400   \n","\n","                                                                                                                                                                                                                                                                                                                                                                                                                                                    History & Impressions  \\\n","0                                                                                                                                                                                                                                                                                                                                                                                                   N31801 N19347 N42782 N45794 N63302 N10414 N18445 N34694 N55189 N55689   \n","1  N43353 N31741 N21164 N59026 N61355 N32852 N59049 N46082 N2511 N21623 N9798 N37509 N8429 N30867 N58224 N6233 N47020 N6087 N13912 N6072 N64467 N16617 N24611 N63317 N58715 N34567 N54225 N61388 N61101 N8129 N51163 N7023 N44383 N13231 N14761 N2663 N65112 N4486 N1569 N29802 N16290 N63045 N31402 N3433 N13008 N30698 N48742 N23979 N62285 N35458 N56514 N10438 N41011 N14340 N59359 N23061 N31739 N31699 N37159 N44462 N22976 N19709 N54889 N29948 N3142 N8275 N17059   \n","2                                                                                                                                                                                                                                                                                                                                                    N26378 N52500 N47289 N62058 N5445 N41087 N18870 N21087 N49475 N7563 N60384 N46616 N33164 N10732 N24233 N25792 N23814   \n","3                                                                                                                                                                                                                                                                                                                                                                                               N29757 N43142 N41375 N871 N2203 N31825 N53880 N45729 N33013 N51891 N49685   \n","4                                                                                                                                                                                                                                                                                                                                                                                                                                       N10078 N14904 N33740 N56514 N8400   \n","\n","                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Average Vector  \n","0                [-0.014606062493754814, -0.02841637492969335, 0.023719813303578086, 0.009556050663624305, -0.04229502665497109, -0.012634033702098712, 0.025006863912623013, -0.0026102875997501135, 0.00793377657774473, 0.005719053512370065, 0.049153281260128204, 0.05749945489872381, 0.026925346099389742, -0.014982412822799274, -0.025055876820228112, -0.023746189567295, 0.005080339706172858, 0.008010757221064476, -0.04396915791593487, 0.0021127053763620165, -0.06642412956471191, -0.012746648982221035, -0.0022455996219859246, 0.0006853153529116363, -0.0012351444187181481, -0.016091391157134576, 0.002439112567173429, -0.006423315420792992, 0.01211253476254524, 0.009400782066094678, -0.014237181864117415, 0.019026322500717258, 0.04758785196220639, -0.04587253953831038, 0.024527962524958154, -0.03714662646084465, -0.05322331354597981, -0.035100688131982125, -0.0044734864333013545, 0.03795193622745108, -0.025963429143521826, 0.03638469596056955, -0.009913495753708364, 0.016632337912644242, -0.018381362213831222, -0.02932669453990925, -0.006303412268038785, 0.039395503069485215, -0.0018032711830857306, 0.007283903120437847, -0.0231982012384921, -0.01576067722869785, 0.035454009785580574, 0.05028668191649095, 0.014613864029587953, 0.03431599349521232, -0.0028338826792617157, -0.012185012552739313, -0.02298737854135876, 0.009832405998956071, -0.004609509098362194, 0.03469953616090543, 0.011528941747851797, 0.014769284940285987, 0.01609200744667112, 0.026100055105888607, -0.02285843102264851, -0.03895301730120606, 0.027643572927700626, -0.014615578402528157, -0.04540764950986314, -0.0055726218631066025, 0.04967636279998334, 0.0429824294916797, -0.03694497350937741, -0.0043948449621826905, -0.009726584098703455, 0.04461912922050087, -0.00026324803551897453, 0.04958850295594698, 0.022808497740811867, -0.023784744676203406, -0.005331226917005444, 0.04307054397984105, 0.04604392893402299, -0.0009926467507086958, 0.013062171327589151, -0.021695856995925966, -0.011250172181620416, -0.009029016311564383, -0.004436389195224032, 0.0404441875799851, 0.022881511630580217, -0.020203295700649167, 0.013582978203417773, -0.05494556589388143, 0.018376246195553475, -0.03565949083262014, -0.002349582923667593, 0.030613149615823405]  \n","1                              [-0.014874674845339069, -0.05529949234559206, 0.03509248088627415, -0.029047531783713953, -0.03453679162347402, -0.06490567029598482, 0.02028504213877174, -0.021955334864570606, 0.02265902159672738, 0.055375542136327484, 0.06290567540679871, 0.047357811809601295, 0.03399533137955915, -0.035920975257421404, -0.05721889396363508, 0.0019631254706504904, -0.001267627887514721, 0.02118808679075704, -0.02374018648702714, -0.009623427631634476, -0.06381329291184963, 0.008928589461783378, -0.0069758921402153125, 0.061695907463311765, 0.029931721249530512, -0.03478574143889415, -0.010629600207806861, -0.005036874191178649, 0.029468111149059572, 0.03365741060531647, -0.021800188680642343, 0.011316232139372079, 0.026064908845698852, -0.047402184299905226, 0.006537286649784697, -0.0073579523861560525, -0.07485792761666551, -0.07362067889636024, -0.02619262176372007, 0.05358701956292679, -0.05084863858979475, 0.03686239011002892, -0.0029164568552575067, -0.011461979099922361, -0.05470061244084292, -0.03743506586985957, -0.02021623373725781, 0.07523892470671227, -0.0002516680198845842, 0.04231420296064069, -0.05715686864835303, 0.0064696826129443845, 0.03269557142120406, 0.019338028587735246, 0.01563975327816757, 0.012799562531997639, -0.01134317368491846, -0.022995879553350862, -0.0028845591549033303, -0.029352452698440664, -0.04614594285310112, 0.058424136028510695, 0.020812682939273044, 0.04526448820677295, 0.0007152350201461722, -0.05805560273931943, -0.060286277731916686, -0.061020784568186055, -0.022856938108059836, -0.05026044932952768, -0.06939924053726104, -0.05597750516556209, 0.07106007337416491, 0.05954362368796894, -0.05657270636158298, -0.017271586971943902, -0.0363184799256465, 0.059725883584011076, 0.018656193703296253, 0.006614491909374183, 0.024980944803673417, -0.02327843781514133, 0.004789596955659253, 0.06680094934342384, 0.04640708350872287, -0.02769242762986397, -0.0008534953180839087, 0.027235875180766988, -0.023689691530745162, -0.037061248133383025, -0.032146208357335754, 0.01803450060678639, 0.0052530278298020755, -0.04787220216345327, -0.026918809462528333, -0.0755282815178653, 0.034072457396502, -0.06224728684678312, -0.02184121885769703, 0.05346186088950782]  \n","2                           [-0.019274555286742826, -0.035196202442915624, 0.04430999446056094, -0.022588688514088906, -0.050842487562845234, -0.06817105452076302, 0.016291525921084907, -0.019124477275101727, 0.02436291512286861, 0.03119729079473163, 0.059718613701050714, 0.05737964799709463, 0.03672013994184467, -0.030112920377329076, -0.07924916044112595, -0.01615659703721983, 0.0034051942905612715, -0.0019888553965011248, -0.02088626557083679, -0.02658154960673542, -0.08590259063607841, 0.013055071638736536, -0.011481616796015306, 0.05058365484551463, 0.024452408317182053, -0.023047579113586337, -0.0042098574093538494, -0.012883824821364503, 0.0357006349692821, 0.04058086779597915, -0.021875187830165715, 0.018750182359641737, 0.053189439989051276, -0.058502853197920354, 0.020514729350811597, -0.03428488680493126, -0.07646604562689431, -0.07767945593167253, -0.02409055588662932, 0.03388461022313535, -0.03288499252327724, 0.03737277143571865, -0.0007559019795485724, -0.002456645012806794, -0.053186031201849726, -0.03403801653409881, -0.014820440878827657, 0.06841967591810116, 0.012472618528336147, 0.035340278121492104, -0.052028241393917346, -0.01716649014509395, 0.04146611377338784, 0.03933807836873208, 0.02054523604722116, 0.040098231744154764, -0.003208655228581948, -0.014381040681486764, -0.001645835233378934, -0.02368089791542233, -0.03534734403661885, 0.046868792097554395, 0.008201025172708352, 0.022579165234582123, 0.005546651154114437, -0.037048347308150265, -0.04364936047416322, -0.06975990845024348, -0.004005670544157638, -0.02709777444893675, -0.06218983020107555, -0.04817626514015164, 0.07298651532364779, 0.062051022858555974, -0.058674206340835706, -0.019989927060530297, -0.025362010192954004, 0.06517147266879345, 0.014590228457303796, 0.016754987122518522, 0.014766662027741502, -0.0210232216050554, -0.006325198736832217, 0.0724764427347196, 0.05764658402738013, -0.022344949928103944, -0.013560992697911296, -0.0005918550125301863, -0.019095145451311912, -0.012984158679345917, -0.028686846206820753, 0.03538098119177331, 0.008411016686285137, -0.04386167143460092, -0.026385766612889806, -0.0849801073097613, 0.02309304916404628, -0.05733809082320814, -0.010878983481915114, 0.06328111523621012]  \n","3       [-0.007892154831904474, -0.026896345018149456, 0.0197346340139477, -0.009982491501157462, -0.027026277249947175, -0.012638191728408597, -0.02077784565593331, 0.01419167953384848, -0.013671401069447094, 0.027842927243947765, 0.02749689198683506, 0.05430508423400149, 0.03547171864004184, -0.005371195135427687, -0.030416132743750986, 0.0020700692589633823, -0.0030953877900044067, -0.008152272786756275, -0.03022015711804451, -0.007796342382197432, -0.051880427280287904, 0.006666280515140521, -0.007538407771312941, 0.0167334663346369, 0.02885311906585294, 0.0038611251847544574, -0.005673119297797556, -0.020242757969833654, 0.0032883648856655064, 0.02328427663760437, 0.010206917367645662, 0.011473090847574823, 0.020284731465630326, -0.019294123129901156, 0.02289647555021794, -0.038332601133496486, -0.0406327349586443, -0.031064189000580108, -0.018564544606075133, 0.01654232457595631, -0.01442923461606893, 0.03026772239445745, -0.009243799919827798, 0.02958430905723971, -0.009665604116196968, -0.0513258669635051, -0.010256000201652977, 0.044875549112950795, -0.005536948271864376, 0.024128979119103392, -0.005626781995513106, 0.004772137800628573, -0.00274581750220535, 0.030240457186856116, 0.012141709263291599, 0.01492200473094543, -0.00117386441083791, -0.027838471972053528, 0.0024468187238274332, -0.0007857752673814118, -0.013435422085669273, 0.027140131516286595, -0.0017992643513248972, 0.0267968109289096, -0.013522291891698696, -0.0013333782573970512, -0.024057218883229207, -0.011518426362593587, -0.013282904168767934, -0.0018690248137825073, -0.04177767691009167, -0.011835781236160104, 0.039039679997649325, 0.04535594379722452, -0.03404472023457022, -0.0021654401733624444, -0.027315315708184185, 0.023151753874816283, 0.02657294181687785, 0.029867992420118446, -0.002048112673207305, 0.005530115374809214, -0.010933542839841763, 0.047053861022926594, 0.029487182594865376, -0.008317452156686236, -0.003108297266270292, -0.019013157956558353, 0.02613209176805775, -0.027558958221553742, -0.0038858946318009405, 0.020127634956935786, 0.009728571151695037, -0.029484186219984276, 0.007509885666928635, -0.04775872172688272, 0.032412326509063734, -0.029307293781798856, 0.006597386743975644, 0.025831412484888547]  \n","4  [0.002464332953308331, -0.02718816235267559, 0.038570458065364445, -0.029758881895052262, -0.011961346237243608, -0.02814457495363848, -0.0030644701284174075, -0.020228406930692562, 0.008929970431126867, 0.04557365640046872, 0.036825873438161266, 0.045096310040695406, 0.02191356661938922, -0.01749483614004326, -0.02623822213504861, -0.0055277731576052706, -0.029659878787793015, -0.00012806466496199982, -0.013465020897675964, -0.013925344468362933, -0.04247298701599582, 0.006549605932149474, -0.0010906838767409492, 0.047449151737580866, 0.0018690138156038556, -0.0005754201028839391, -0.004998445252832201, -0.025621024103382795, 0.01318639387151908, 0.030305235910261706, -0.002348462576550236, 0.014029894470995513, 0.007743910802267988, -0.02443591262582523, 0.0020079618536127607, -0.017810464289739196, -0.028288750141066188, -0.05364846430429275, -0.0031097323727601227, 0.013856064514837832, -0.029050152585308353, 0.024810940621203682, -0.0014986739641487073, 0.008817944216267644, -0.020888612965622465, -0.020963238889693463, 0.006611985370700638, 0.03476477963950956, -0.0016449461884379389, 0.044851983701613564, -0.042719991549653044, 0.005004600943630368, 0.0006501389245785365, -0.004299019916379397, 0.012114278279254754, 0.010137210320861215, -0.012441416486490863, -0.02313532375525652, 0.03141421442235529, -0.03863457397577148, -0.048230965909561954, 0.03951435733784931, 0.002433167140543696, 0.012844312890842096, -0.01842498671755583, -0.021947557341565834, -0.0559259628048955, -0.032953393236726566, -0.015147032178687245, -0.037736092371403705, -0.028076042402332024, -0.04225658657993282, 0.04584131374543147, 0.04929927389430225, -0.02612104618095091, -0.01306366968427446, -0.044491226575814294, 0.03418275963014913, 0.030689207911663387, 0.009294632645880926, 0.007769612464024212, 0.000258767582121322, -0.010032331387901137, 0.04097435230674081, 0.018657232139055274, -0.04030115998725945, -0.0053365715163212115, 0.009409695935690248, -0.009463322934399648, -0.03341104095830871, -0.03748062539440114, -0.0013216278141608656, -0.011300744843256171, -0.0569714195368351, -0.032049371611254415, -0.05482275065410121, 0.03465766050248055, -0.060556459689332306, 0.000662779957913974, 0.021234565832266523]  "],"text/html":["\n","  <div id=\"df-029ca4e0-6b72-444e-9bdd-d71960d6b358\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>User ID</th>\n","      <th>Timestamp</th>\n","      <th>History</th>\n","      <th>Impressions</th>\n","      <th>History &amp; Impressions</th>\n","      <th>Average Vector</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>U13740</td>\n","      <td>2019-11-11 09:05:58</td>\n","      <td>N31801 N19347 N42782 N45794 N63302 N10414 N18445 N34694 N55189</td>\n","      <td>N55689</td>\n","      <td>N31801 N19347 N42782 N45794 N63302 N10414 N18445 N34694 N55189 N55689</td>\n","      <td>[-0.014606062493754814, -0.02841637492969335, 0.023719813303578086, 0.009556050663624305, -0.04229502665497109, -0.012634033702098712, 0.025006863912623013, -0.0026102875997501135, 0.00793377657774473, 0.005719053512370065, 0.049153281260128204, 0.05749945489872381, 0.026925346099389742, -0.014982412822799274, -0.025055876820228112, -0.023746189567295, 0.005080339706172858, 0.008010757221064476, -0.04396915791593487, 0.0021127053763620165, -0.06642412956471191, -0.012746648982221035, -0.0022455996219859246, 0.0006853153529116363, -0.0012351444187181481, -0.016091391157134576, 0.002439112567173429, -0.006423315420792992, 0.01211253476254524, 0.009400782066094678, -0.014237181864117415, 0.019026322500717258, 0.04758785196220639, -0.04587253953831038, 0.024527962524958154, -0.03714662646084465, -0.05322331354597981, -0.035100688131982125, -0.0044734864333013545, 0.03795193622745108, -0.025963429143521826, 0.03638469596056955, -0.009913495753708364, 0.016632337912644242, -0.018381362213831222, -0.02932669453990925, -0.006303412268038785, 0.039395503069485215, -0.0018032711830857306, 0.007283903120437847, -0.0231982012384921, -0.01576067722869785, 0.035454009785580574, 0.05028668191649095, 0.014613864029587953, 0.03431599349521232, -0.0028338826792617157, -0.012185012552739313, -0.02298737854135876, 0.009832405998956071, -0.004609509098362194, 0.03469953616090543, 0.011528941747851797, 0.014769284940285987, 0.01609200744667112, 0.026100055105888607, -0.02285843102264851, -0.03895301730120606, 0.027643572927700626, -0.014615578402528157, -0.04540764950986314, -0.0055726218631066025, 0.04967636279998334, 0.0429824294916797, -0.03694497350937741, -0.0043948449621826905, -0.009726584098703455, 0.04461912922050087, -0.00026324803551897453, 0.04958850295594698, 0.022808497740811867, -0.023784744676203406, -0.005331226917005444, 0.04307054397984105, 0.04604392893402299, -0.0009926467507086958, 0.013062171327589151, -0.021695856995925966, -0.011250172181620416, -0.009029016311564383, -0.004436389195224032, 0.0404441875799851, 0.022881511630580217, -0.020203295700649167, 0.013582978203417773, -0.05494556589388143, 0.018376246195553475, -0.03565949083262014, -0.002349582923667593, 0.030613149615823405]</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>U91836</td>\n","      <td>2019-11-12 18:11:30</td>\n","      <td>N43353 N31741 N21164 N59026 N61355 N32852 N59049 N46082 N2511 N21623 N9798 N37509 N8429 N30867 N58224 N6233 N47020 N6087 N13912 N6072 N64467 N16617 N24611 N63317 N58715 N34567 N54225 N61388 N61101 N8129 N51163 N7023 N44383 N13231 N14761 N2663 N65112 N4486 N1569 N29802 N16290 N63045 N31402 N3433 N13008 N30698 N48742 N23979 N62285 N35458 N56514 N10438 N41011 N14340 N59359 N23061 N31739 N31699 N37159 N44462 N22976 N19709 N54889 N29948 N3142 N8275</td>\n","      <td>N17059</td>\n","      <td>N43353 N31741 N21164 N59026 N61355 N32852 N59049 N46082 N2511 N21623 N9798 N37509 N8429 N30867 N58224 N6233 N47020 N6087 N13912 N6072 N64467 N16617 N24611 N63317 N58715 N34567 N54225 N61388 N61101 N8129 N51163 N7023 N44383 N13231 N14761 N2663 N65112 N4486 N1569 N29802 N16290 N63045 N31402 N3433 N13008 N30698 N48742 N23979 N62285 N35458 N56514 N10438 N41011 N14340 N59359 N23061 N31739 N31699 N37159 N44462 N22976 N19709 N54889 N29948 N3142 N8275 N17059</td>\n","      <td>[-0.014874674845339069, -0.05529949234559206, 0.03509248088627415, -0.029047531783713953, -0.03453679162347402, -0.06490567029598482, 0.02028504213877174, -0.021955334864570606, 0.02265902159672738, 0.055375542136327484, 0.06290567540679871, 0.047357811809601295, 0.03399533137955915, -0.035920975257421404, -0.05721889396363508, 0.0019631254706504904, -0.001267627887514721, 0.02118808679075704, -0.02374018648702714, -0.009623427631634476, -0.06381329291184963, 0.008928589461783378, -0.0069758921402153125, 0.061695907463311765, 0.029931721249530512, -0.03478574143889415, -0.010629600207806861, -0.005036874191178649, 0.029468111149059572, 0.03365741060531647, -0.021800188680642343, 0.011316232139372079, 0.026064908845698852, -0.047402184299905226, 0.006537286649784697, -0.0073579523861560525, -0.07485792761666551, -0.07362067889636024, -0.02619262176372007, 0.05358701956292679, -0.05084863858979475, 0.03686239011002892, -0.0029164568552575067, -0.011461979099922361, -0.05470061244084292, -0.03743506586985957, -0.02021623373725781, 0.07523892470671227, -0.0002516680198845842, 0.04231420296064069, -0.05715686864835303, 0.0064696826129443845, 0.03269557142120406, 0.019338028587735246, 0.01563975327816757, 0.012799562531997639, -0.01134317368491846, -0.022995879553350862, -0.0028845591549033303, -0.029352452698440664, -0.04614594285310112, 0.058424136028510695, 0.020812682939273044, 0.04526448820677295, 0.0007152350201461722, -0.05805560273931943, -0.060286277731916686, -0.061020784568186055, -0.022856938108059836, -0.05026044932952768, -0.06939924053726104, -0.05597750516556209, 0.07106007337416491, 0.05954362368796894, -0.05657270636158298, -0.017271586971943902, -0.0363184799256465, 0.059725883584011076, 0.018656193703296253, 0.006614491909374183, 0.024980944803673417, -0.02327843781514133, 0.004789596955659253, 0.06680094934342384, 0.04640708350872287, -0.02769242762986397, -0.0008534953180839087, 0.027235875180766988, -0.023689691530745162, -0.037061248133383025, -0.032146208357335754, 0.01803450060678639, 0.0052530278298020755, -0.04787220216345327, -0.026918809462528333, -0.0755282815178653, 0.034072457396502, -0.06224728684678312, -0.02184121885769703, 0.05346186088950782]</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>U73700</td>\n","      <td>2019-11-14 07:01:48</td>\n","      <td>N26378 N52500 N47289 N62058 N5445 N41087 N18870 N21087 N49475 N7563 N60384 N46616 N33164 N10732 N24233 N25792</td>\n","      <td>N23814</td>\n","      <td>N26378 N52500 N47289 N62058 N5445 N41087 N18870 N21087 N49475 N7563 N60384 N46616 N33164 N10732 N24233 N25792 N23814</td>\n","      <td>[-0.019274555286742826, -0.035196202442915624, 0.04430999446056094, -0.022588688514088906, -0.050842487562845234, -0.06817105452076302, 0.016291525921084907, -0.019124477275101727, 0.02436291512286861, 0.03119729079473163, 0.059718613701050714, 0.05737964799709463, 0.03672013994184467, -0.030112920377329076, -0.07924916044112595, -0.01615659703721983, 0.0034051942905612715, -0.0019888553965011248, -0.02088626557083679, -0.02658154960673542, -0.08590259063607841, 0.013055071638736536, -0.011481616796015306, 0.05058365484551463, 0.024452408317182053, -0.023047579113586337, -0.0042098574093538494, -0.012883824821364503, 0.0357006349692821, 0.04058086779597915, -0.021875187830165715, 0.018750182359641737, 0.053189439989051276, -0.058502853197920354, 0.020514729350811597, -0.03428488680493126, -0.07646604562689431, -0.07767945593167253, -0.02409055588662932, 0.03388461022313535, -0.03288499252327724, 0.03737277143571865, -0.0007559019795485724, -0.002456645012806794, -0.053186031201849726, -0.03403801653409881, -0.014820440878827657, 0.06841967591810116, 0.012472618528336147, 0.035340278121492104, -0.052028241393917346, -0.01716649014509395, 0.04146611377338784, 0.03933807836873208, 0.02054523604722116, 0.040098231744154764, -0.003208655228581948, -0.014381040681486764, -0.001645835233378934, -0.02368089791542233, -0.03534734403661885, 0.046868792097554395, 0.008201025172708352, 0.022579165234582123, 0.005546651154114437, -0.037048347308150265, -0.04364936047416322, -0.06975990845024348, -0.004005670544157638, -0.02709777444893675, -0.06218983020107555, -0.04817626514015164, 0.07298651532364779, 0.062051022858555974, -0.058674206340835706, -0.019989927060530297, -0.025362010192954004, 0.06517147266879345, 0.014590228457303796, 0.016754987122518522, 0.014766662027741502, -0.0210232216050554, -0.006325198736832217, 0.0724764427347196, 0.05764658402738013, -0.022344949928103944, -0.013560992697911296, -0.0005918550125301863, -0.019095145451311912, -0.012984158679345917, -0.028686846206820753, 0.03538098119177331, 0.008411016686285137, -0.04386167143460092, -0.026385766612889806, -0.0849801073097613, 0.02309304916404628, -0.05733809082320814, -0.010878983481915114, 0.06328111523621012]</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>U34670</td>\n","      <td>2019-11-11 05:28:05</td>\n","      <td>N29757 N43142 N41375 N871 N2203 N31825 N53880 N45729 N33013 N51891</td>\n","      <td>N49685</td>\n","      <td>N29757 N43142 N41375 N871 N2203 N31825 N53880 N45729 N33013 N51891 N49685</td>\n","      <td>[-0.007892154831904474, -0.026896345018149456, 0.0197346340139477, -0.009982491501157462, -0.027026277249947175, -0.012638191728408597, -0.02077784565593331, 0.01419167953384848, -0.013671401069447094, 0.027842927243947765, 0.02749689198683506, 0.05430508423400149, 0.03547171864004184, -0.005371195135427687, -0.030416132743750986, 0.0020700692589633823, -0.0030953877900044067, -0.008152272786756275, -0.03022015711804451, -0.007796342382197432, -0.051880427280287904, 0.006666280515140521, -0.007538407771312941, 0.0167334663346369, 0.02885311906585294, 0.0038611251847544574, -0.005673119297797556, -0.020242757969833654, 0.0032883648856655064, 0.02328427663760437, 0.010206917367645662, 0.011473090847574823, 0.020284731465630326, -0.019294123129901156, 0.02289647555021794, -0.038332601133496486, -0.0406327349586443, -0.031064189000580108, -0.018564544606075133, 0.01654232457595631, -0.01442923461606893, 0.03026772239445745, -0.009243799919827798, 0.02958430905723971, -0.009665604116196968, -0.0513258669635051, -0.010256000201652977, 0.044875549112950795, -0.005536948271864376, 0.024128979119103392, -0.005626781995513106, 0.004772137800628573, -0.00274581750220535, 0.030240457186856116, 0.012141709263291599, 0.01492200473094543, -0.00117386441083791, -0.027838471972053528, 0.0024468187238274332, -0.0007857752673814118, -0.013435422085669273, 0.027140131516286595, -0.0017992643513248972, 0.0267968109289096, -0.013522291891698696, -0.0013333782573970512, -0.024057218883229207, -0.011518426362593587, -0.013282904168767934, -0.0018690248137825073, -0.04177767691009167, -0.011835781236160104, 0.039039679997649325, 0.04535594379722452, -0.03404472023457022, -0.0021654401733624444, -0.027315315708184185, 0.023151753874816283, 0.02657294181687785, 0.029867992420118446, -0.002048112673207305, 0.005530115374809214, -0.010933542839841763, 0.047053861022926594, 0.029487182594865376, -0.008317452156686236, -0.003108297266270292, -0.019013157956558353, 0.02613209176805775, -0.027558958221553742, -0.0038858946318009405, 0.020127634956935786, 0.009728571151695037, -0.029484186219984276, 0.007509885666928635, -0.04775872172688272, 0.032412326509063734, -0.029307293781798856, 0.006597386743975644, 0.025831412484888547]</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>U8125</td>\n","      <td>2019-11-12 16:11:21</td>\n","      <td>N10078 N14904 N33740 N56514</td>\n","      <td>N8400</td>\n","      <td>N10078 N14904 N33740 N56514 N8400</td>\n","      <td>[0.002464332953308331, -0.02718816235267559, 0.038570458065364445, -0.029758881895052262, -0.011961346237243608, -0.02814457495363848, -0.0030644701284174075, -0.020228406930692562, 0.008929970431126867, 0.04557365640046872, 0.036825873438161266, 0.045096310040695406, 0.02191356661938922, -0.01749483614004326, -0.02623822213504861, -0.0055277731576052706, -0.029659878787793015, -0.00012806466496199982, -0.013465020897675964, -0.013925344468362933, -0.04247298701599582, 0.006549605932149474, -0.0010906838767409492, 0.047449151737580866, 0.0018690138156038556, -0.0005754201028839391, -0.004998445252832201, -0.025621024103382795, 0.01318639387151908, 0.030305235910261706, -0.002348462576550236, 0.014029894470995513, 0.007743910802267988, -0.02443591262582523, 0.0020079618536127607, -0.017810464289739196, -0.028288750141066188, -0.05364846430429275, -0.0031097323727601227, 0.013856064514837832, -0.029050152585308353, 0.024810940621203682, -0.0014986739641487073, 0.008817944216267644, -0.020888612965622465, -0.020963238889693463, 0.006611985370700638, 0.03476477963950956, -0.0016449461884379389, 0.044851983701613564, -0.042719991549653044, 0.005004600943630368, 0.0006501389245785365, -0.004299019916379397, 0.012114278279254754, 0.010137210320861215, -0.012441416486490863, -0.02313532375525652, 0.03141421442235529, -0.03863457397577148, -0.048230965909561954, 0.03951435733784931, 0.002433167140543696, 0.012844312890842096, -0.01842498671755583, -0.021947557341565834, -0.0559259628048955, -0.032953393236726566, -0.015147032178687245, -0.037736092371403705, -0.028076042402332024, -0.04225658657993282, 0.04584131374543147, 0.04929927389430225, -0.02612104618095091, -0.01306366968427446, -0.044491226575814294, 0.03418275963014913, 0.030689207911663387, 0.009294632645880926, 0.007769612464024212, 0.000258767582121322, -0.010032331387901137, 0.04097435230674081, 0.018657232139055274, -0.04030115998725945, -0.0053365715163212115, 0.009409695935690248, -0.009463322934399648, -0.03341104095830871, -0.03748062539440114, -0.0013216278141608656, -0.011300744843256171, -0.0569714195368351, -0.032049371611254415, -0.05482275065410121, 0.03465766050248055, -0.060556459689332306, 0.000662779957913974, 0.021234565832266523]</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-029ca4e0-6b72-444e-9bdd-d71960d6b358')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-029ca4e0-6b72-444e-9bdd-d71960d6b358 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-029ca4e0-6b72-444e-9bdd-d71960d6b358');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":171}]},{"cell_type":"code","source":["news = pd.read_pickle(f\"/content/drive/MyDrive/Group_19/01.Dataset/{size}/Clean/{version}/news.pkl\")"],"metadata":{"id":"D9UDAdAJTGn4"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["news.head()"],"metadata":{"id":"yCRkUKL600lz","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1688054710442,"user_tz":-120,"elapsed":18,"user":{"displayName":"Vasco Oliveira","userId":"01429743951160621812"}},"outputId":"fe82fd7f-2a0a-40c7-ce58-c14f109beb0b"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["  News ID   Category       SubCategory  \\\n","0  N55528  lifestyle  lifestyle royals   \n","1  N19639     health       weight loss   \n","2  N61837       news        news world   \n","3  N53526     health            voices   \n","4  N38324     health           medical   \n","\n","                                                                    Title  \\\n","0  the brands queen elizabeth, prince charles, and prince philip swear by   \n","1                                           50 worst habits for belly fat   \n","2         the cost of trump's aid freeze in the trenches of ukraine's war   \n","3             i was an nba wife. here's how it affected my mental health.   \n","4               how to get rid of skin tags, according to a dermatologist   \n","\n","                                                                                                                                                                                               Abstract  \\\n","0                                                                                                                             shop the notebooks, jackets, and more that the royals can't live without.   \n","1                                                                                  these seemingly harmless habits are holding you back and keeping you from shedding that unwanted belly fat for good.   \n","2  lt. ivan molchanets peeked over a parapet of sand bags at the front line of the war in ukraine. next to him was an empty helmet propped up to trick snipers, already perforated with multiple holes.   \n","3                                                                                                   i felt like i was a fraud, and being an nba wife didn't help that. in fact, it nearly destroyed me.   \n","4                   they seem harmless, but there's a very good reason you shouldn't ignore them. the post how to get rid of skin tags, according to a dermatologist appeared first on reader's digest.   \n","\n","                                                                                                                                                                                                                                                                          Content  \\\n","0                                                                                                           lifestyle lifestyle royals the brands queen elizabeth prince charles and prince philip swear by shop the notebooks jackets and more that the royals cant live without   \n","1                                                                                                            health weight loss 50 worst habits for belly fat these seemingly harmless habits are holding you back and keeping you from shedding that unwanted belly fat for good   \n","2  news news world the cost of trumps aid freeze in the trenches of ukraines war lt ivan molchanets peeked over a parapet of sand bags at the front line of the war in ukraine next to him was an empty helmet propped up to trick snipers already perforated with multiple holes   \n","3                                                                                                           health voices i was an nba wife heres how it affected my mental health i felt like i was a fraud and being an nba wife didnt help that in fact it nearly destroyed me   \n","4                            health medical how to get rid of skin tags according to a dermatologist they seem harmless but theres a very good reason you shouldnt ignore them the post how to get rid of skin tags according to a dermatologist appeared first on readers digest   \n","\n","   Content_WC  \\\n","0          26   \n","1          28   \n","2          51   \n","3          35   \n","4          44   \n","\n","                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Average Vector  \n","0  [0.004057333333333334, -0.03991733333333333, -0.008374, 0.07914233333333333, -0.020229666666666663, -0.022213, 0.040847666666666664, 0.0014350000000000005, 0.061828666666666664, -0.031631, 0.023040333333333333, 0.04310766666666666, 0.023592, -0.061693, 0.015099000000000001, -0.07910833333333334, 0.028382666666666667, 0.10652766666666667, -0.008534333333333333, -0.01902066666666667, 0.011596, -0.092748, 0.07943733333333333, -0.08211, -0.07028966666666668, -0.10451899999999999, 0.011144333333333334, -0.009591, 0.04464566666666667, -0.081025, -0.06339066666666666, -0.020261666666666667, 0.08129033333333334, 0.031477333333333336, -0.07450066666666667, 0.012981, -0.003404666666666667, 0.010823333333333332, -0.065875, 0.017982, -0.055929666666666676, 0.08072766666666667, -0.07246833333333333, 0.025115, -0.11045533333333334, 0.041048, -0.011876000000000003, -0.00434, -0.002706999999999999, -0.001977333333333333, 0.022897666666666667, 0.066106, 0.010144333333333333, 0.04570766666666667, 0.044172333333333334, 0.07795266666666667, 0.014355333333333331, 0.07450999999999999, -0.038349666666666664, -0.011252666666666666, 0.09210466666666665, -0.07734766666666666, 0.035256, -0.05846233333333334, 0.061819000000000006, 0.08261533333333333, 0.029722666666666665, 0.029845999999999998, -0.035560666666666664, 0.05244833333333334, -0.004362, 0.02662, -0.05474266666666666, 0.0003316666666666653, -0.019636666666666667, -0.004569333333333334, 0.03388133333333333, -0.021329333333333336, 0.0013953333333333328, 0.082415, 0.06908733333333333, -0.011366000000000001, -0.0005483333333333335, 0.013892, -0.011874000000000001, -0.063751, 0.076371, 0.03708566666666667, -0.001979999999999999, -0.027107666666666665, -0.073342, 0.014615999999999999, 0.05578533333333333, 0.024075666666666672, 0.026349333333333332, -0.05218166666666666, 0.046934, -0.024919666666666663, 0.07169866666666667, -0.03612766666666667]  \n","1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 [-0.013597, -0.009758, 0.01712, -0.051993, 0.037963, 0.045238, 0.077176, -0.033402, 0.032126, 0.000231, -0.041168, 0.006686, -0.042137, 0.003012, -0.007492, 0.004021, -0.044446, 0.060362, 0.036527, 0.000915, -0.0881, 0.013638, 0.00664, 0.023534, -0.006483, -0.030089, -0.01769, -0.076201, 0.010523, -0.015482, -0.029464, -0.000577, 0.011122, 0.020931, 0.019831, -0.020024, 0.046285, -0.087435, -0.014035, -0.032755, 0.000882, 0.058146, -0.063754, -0.01612, -0.028519, -0.006055, 0.043857, 0.012439, 0.008123, 0.068035, -0.025732, -0.082524, 0.012157, 0.005102, 0.050669, -0.029057, -0.097563, 0.01637, 0.104147, -0.013962, -0.085338, 0.002964, 0.002371, 0.033141, -0.094885, -0.041572, -0.083391, -0.017752, -0.021868, 0.003052, 0.065026, 0.018371, -0.009355, 0.078348, 0.028948, -0.043366, 0.007608, 0.031137, 0.054513, 0.030671, -0.021131, -0.048048, -0.013872, -0.000741, -0.059595, -0.109701, 0.046302, 0.016114, 0.05821, -0.015325, -0.085929, -0.059981, 0.004588, -0.028985, -0.059973, -0.035562, 0.106053, -0.10042, 0.051723, 0.001144]  \n","2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      [-0.065324, -0.088163, -0.015203, -0.031949, 0.091263, -0.228807, -0.005629, -0.199308, 0.158042, 0.157506, 0.112573, 0.11353, -0.05826, -0.000931, -0.182976, 0.095299, 0.011588, 0.081224, 0.041808, -0.114242, 0.050847, 0.000613, -0.025367, 0.104747, -0.019483, -0.044524, 0.014938, -0.020598, 0.074194, 0.143272, -0.090134, 0.024378, 0.016504, 0.073597, -0.000753, 0.014563, -0.086061, -0.097182, -0.176203, 0.091886, -0.090757, -0.057736, 0.070559, -0.00314, -0.208355, 0.07014, -0.089793, 0.102981, -0.055766, 0.080064, -0.171543, 0.084593, -0.021262, -0.070932, 0.094243, 0.094618, -0.060624, -0.103646, 0.016896, -0.022969, -0.06224, 0.083993, 0.050859, 0.170461, -0.040692, -0.231475, -0.054997, -0.139666, -0.182166, -0.154107, -0.103189, -0.191087, 0.114531, 0.107967, 0.049184, -0.003082, -0.130202, 0.236282, 0.037841, -0.041989, 0.095108, -8.8e-05, 0.004326, 0.030816, -0.018787, -0.009449, -0.073514, 0.034427, -0.075651, -0.108221, -0.147075, -0.088895, -0.102027, -0.058871, -0.156666, -0.099688, 0.020397, -0.086153, -0.046413, 0.066968]  \n","3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                [0.003752, -0.061771, -0.037073, 0.02677, -0.090658, 0.012813, -0.092285, 0.074664, -0.066141, 0.035619, 0.001939, 0.118046, 0.106249, -0.11127, -0.00702, 0.034989, 0.029654, 0.008367, -0.050007, -0.030704, -0.065894, 0.08123, -0.04539, -0.040012, 0.090774, 0.067699, -0.028125, -0.026579, -0.079355, 0.059613, 0.020613, 0.042591, 0.009983, -0.037203, 0.038242, -0.09384, -0.154576, -0.004471, -0.140145, -0.110083, 0.083281, 0.048921, 0.051276, 0.108326, 0.007419, -0.085701, -0.047435, 0.114793, -0.048882, -0.002836, 0.038695, -0.034756, -0.000584, 0.052104, -0.003848, 0.034386, 0.05696, -0.023321, -0.03635, -0.004535, 0.006874, 0.076202, -0.050935, 0.000466, -0.039141, -0.017551, -0.077054, -0.000394, -0.054463, -0.058872, -0.053088, 0.023609, 0.09061, 0.046973, -0.114502, -0.05578, -0.056306, 0.013576, -0.008754, 0.129473, 0.010713, 0.107132, 0.053372, 0.049199, 0.025105, -0.046849, -0.022099, -0.007698, 0.069537, -0.060824, -0.007802, 0.051335, 0.028594, -0.113466, -0.007955, -0.051726, 0.01268, -0.058242, -0.035847, 0.010902]  \n","4                                                                                                                                                                                                                                                      [-0.002881, 0.004461749999999999, 0.0216455, -0.0319155, 0.01663025, 0.010054749999999998, -0.01916075, -0.021661, -0.01865675, 0.05306275, 0.05101875, 0.005004500000000002, 0.032266249999999996, -0.007904750000000002, -0.029127, 0.0254845, 0.0004097499999999995, -0.0067407499999999985, -0.013089, -0.0030437500000000004, -0.015913, -0.0433275, 0.011350749999999998, 0.0525345, -0.0008897500000000008, 0.02573975, -0.007651999999999997, -0.00929225, 0.0448065, 0.018117, -0.0359185, 0.03973525, -0.00552225, -0.008944, 0.01508225, -0.016991250000000003, 0.01503075, -0.0601835, -0.01010925, -0.02391925, -0.0075657499999999996, 0.028589999999999997, 0.002065249999999999, 0.031218000000000003, -0.0029339999999999995, -0.0020675, 0.022651249999999998, 0.0024807500000000003, -0.00855425, 0.0010757499999999999, -0.0507135, 0.04121725, -0.0025839999999999995, 0.03242725, 0.0178115, 0.028885249999999994, 0.0324305, 0.0028447499999999983, -0.0030939999999999995, -0.0057535, -0.05343825000000001, 0.0381715, 0.004730500000000004, 0.014446249999999999, 0.0025997500000000014, -0.04085825, -0.05733099999999999, -0.002074000000000001, 0.0099355, -0.007765749999999998, 0.016694999999999998, -0.03809125, -0.0006677500000000017, 0.03310325, -0.0072145, -0.009807249999999998, -0.06560475, 0.025306500000000003, 0.043265, 0.0157745, -0.01787275, 0.01142425, 0.0043125, 0.008035500000000001, 0.01093525, -0.06853875, 0.012272749999999999, -0.00288825, 0.018862249999999997, -0.032462000000000005, -0.025650000000000006, 0.0008900000000000002, -0.033017, -0.041723750000000004, 0.022862, -0.0597975, 0.030372500000000004, -0.070557, 0.03394275, 0.026708749999999996]  "],"text/html":["\n","  <div id=\"df-1647709e-cecd-47c4-bb7d-c7dca2299601\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>News ID</th>\n","      <th>Category</th>\n","      <th>SubCategory</th>\n","      <th>Title</th>\n","      <th>Abstract</th>\n","      <th>Content</th>\n","      <th>Content_WC</th>\n","      <th>Average Vector</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>N55528</td>\n","      <td>lifestyle</td>\n","      <td>lifestyle royals</td>\n","      <td>the brands queen elizabeth, prince charles, and prince philip swear by</td>\n","      <td>shop the notebooks, jackets, and more that the royals can't live without.</td>\n","      <td>lifestyle lifestyle royals the brands queen elizabeth prince charles and prince philip swear by shop the notebooks jackets and more that the royals cant live without</td>\n","      <td>26</td>\n","      <td>[0.004057333333333334, -0.03991733333333333, -0.008374, 0.07914233333333333, -0.020229666666666663, -0.022213, 0.040847666666666664, 0.0014350000000000005, 0.061828666666666664, -0.031631, 0.023040333333333333, 0.04310766666666666, 0.023592, -0.061693, 0.015099000000000001, -0.07910833333333334, 0.028382666666666667, 0.10652766666666667, -0.008534333333333333, -0.01902066666666667, 0.011596, -0.092748, 0.07943733333333333, -0.08211, -0.07028966666666668, -0.10451899999999999, 0.011144333333333334, -0.009591, 0.04464566666666667, -0.081025, -0.06339066666666666, -0.020261666666666667, 0.08129033333333334, 0.031477333333333336, -0.07450066666666667, 0.012981, -0.003404666666666667, 0.010823333333333332, -0.065875, 0.017982, -0.055929666666666676, 0.08072766666666667, -0.07246833333333333, 0.025115, -0.11045533333333334, 0.041048, -0.011876000000000003, -0.00434, -0.002706999999999999, -0.001977333333333333, 0.022897666666666667, 0.066106, 0.010144333333333333, 0.04570766666666667, 0.044172333333333334, 0.07795266666666667, 0.014355333333333331, 0.07450999999999999, -0.038349666666666664, -0.011252666666666666, 0.09210466666666665, -0.07734766666666666, 0.035256, -0.05846233333333334, 0.061819000000000006, 0.08261533333333333, 0.029722666666666665, 0.029845999999999998, -0.035560666666666664, 0.05244833333333334, -0.004362, 0.02662, -0.05474266666666666, 0.0003316666666666653, -0.019636666666666667, -0.004569333333333334, 0.03388133333333333, -0.021329333333333336, 0.0013953333333333328, 0.082415, 0.06908733333333333, -0.011366000000000001, -0.0005483333333333335, 0.013892, -0.011874000000000001, -0.063751, 0.076371, 0.03708566666666667, -0.001979999999999999, -0.027107666666666665, -0.073342, 0.014615999999999999, 0.05578533333333333, 0.024075666666666672, 0.026349333333333332, -0.05218166666666666, 0.046934, -0.024919666666666663, 0.07169866666666667, -0.03612766666666667]</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>N19639</td>\n","      <td>health</td>\n","      <td>weight loss</td>\n","      <td>50 worst habits for belly fat</td>\n","      <td>these seemingly harmless habits are holding you back and keeping you from shedding that unwanted belly fat for good.</td>\n","      <td>health weight loss 50 worst habits for belly fat these seemingly harmless habits are holding you back and keeping you from shedding that unwanted belly fat for good</td>\n","      <td>28</td>\n","      <td>[-0.013597, -0.009758, 0.01712, -0.051993, 0.037963, 0.045238, 0.077176, -0.033402, 0.032126, 0.000231, -0.041168, 0.006686, -0.042137, 0.003012, -0.007492, 0.004021, -0.044446, 0.060362, 0.036527, 0.000915, -0.0881, 0.013638, 0.00664, 0.023534, -0.006483, -0.030089, -0.01769, -0.076201, 0.010523, -0.015482, -0.029464, -0.000577, 0.011122, 0.020931, 0.019831, -0.020024, 0.046285, -0.087435, -0.014035, -0.032755, 0.000882, 0.058146, -0.063754, -0.01612, -0.028519, -0.006055, 0.043857, 0.012439, 0.008123, 0.068035, -0.025732, -0.082524, 0.012157, 0.005102, 0.050669, -0.029057, -0.097563, 0.01637, 0.104147, -0.013962, -0.085338, 0.002964, 0.002371, 0.033141, -0.094885, -0.041572, -0.083391, -0.017752, -0.021868, 0.003052, 0.065026, 0.018371, -0.009355, 0.078348, 0.028948, -0.043366, 0.007608, 0.031137, 0.054513, 0.030671, -0.021131, -0.048048, -0.013872, -0.000741, -0.059595, -0.109701, 0.046302, 0.016114, 0.05821, -0.015325, -0.085929, -0.059981, 0.004588, -0.028985, -0.059973, -0.035562, 0.106053, -0.10042, 0.051723, 0.001144]</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>N61837</td>\n","      <td>news</td>\n","      <td>news world</td>\n","      <td>the cost of trump's aid freeze in the trenches of ukraine's war</td>\n","      <td>lt. ivan molchanets peeked over a parapet of sand bags at the front line of the war in ukraine. next to him was an empty helmet propped up to trick snipers, already perforated with multiple holes.</td>\n","      <td>news news world the cost of trumps aid freeze in the trenches of ukraines war lt ivan molchanets peeked over a parapet of sand bags at the front line of the war in ukraine next to him was an empty helmet propped up to trick snipers already perforated with multiple holes</td>\n","      <td>51</td>\n","      <td>[-0.065324, -0.088163, -0.015203, -0.031949, 0.091263, -0.228807, -0.005629, -0.199308, 0.158042, 0.157506, 0.112573, 0.11353, -0.05826, -0.000931, -0.182976, 0.095299, 0.011588, 0.081224, 0.041808, -0.114242, 0.050847, 0.000613, -0.025367, 0.104747, -0.019483, -0.044524, 0.014938, -0.020598, 0.074194, 0.143272, -0.090134, 0.024378, 0.016504, 0.073597, -0.000753, 0.014563, -0.086061, -0.097182, -0.176203, 0.091886, -0.090757, -0.057736, 0.070559, -0.00314, -0.208355, 0.07014, -0.089793, 0.102981, -0.055766, 0.080064, -0.171543, 0.084593, -0.021262, -0.070932, 0.094243, 0.094618, -0.060624, -0.103646, 0.016896, -0.022969, -0.06224, 0.083993, 0.050859, 0.170461, -0.040692, -0.231475, -0.054997, -0.139666, -0.182166, -0.154107, -0.103189, -0.191087, 0.114531, 0.107967, 0.049184, -0.003082, -0.130202, 0.236282, 0.037841, -0.041989, 0.095108, -8.8e-05, 0.004326, 0.030816, -0.018787, -0.009449, -0.073514, 0.034427, -0.075651, -0.108221, -0.147075, -0.088895, -0.102027, -0.058871, -0.156666, -0.099688, 0.020397, -0.086153, -0.046413, 0.066968]</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>N53526</td>\n","      <td>health</td>\n","      <td>voices</td>\n","      <td>i was an nba wife. here's how it affected my mental health.</td>\n","      <td>i felt like i was a fraud, and being an nba wife didn't help that. in fact, it nearly destroyed me.</td>\n","      <td>health voices i was an nba wife heres how it affected my mental health i felt like i was a fraud and being an nba wife didnt help that in fact it nearly destroyed me</td>\n","      <td>35</td>\n","      <td>[0.003752, -0.061771, -0.037073, 0.02677, -0.090658, 0.012813, -0.092285, 0.074664, -0.066141, 0.035619, 0.001939, 0.118046, 0.106249, -0.11127, -0.00702, 0.034989, 0.029654, 0.008367, -0.050007, -0.030704, -0.065894, 0.08123, -0.04539, -0.040012, 0.090774, 0.067699, -0.028125, -0.026579, -0.079355, 0.059613, 0.020613, 0.042591, 0.009983, -0.037203, 0.038242, -0.09384, -0.154576, -0.004471, -0.140145, -0.110083, 0.083281, 0.048921, 0.051276, 0.108326, 0.007419, -0.085701, -0.047435, 0.114793, -0.048882, -0.002836, 0.038695, -0.034756, -0.000584, 0.052104, -0.003848, 0.034386, 0.05696, -0.023321, -0.03635, -0.004535, 0.006874, 0.076202, -0.050935, 0.000466, -0.039141, -0.017551, -0.077054, -0.000394, -0.054463, -0.058872, -0.053088, 0.023609, 0.09061, 0.046973, -0.114502, -0.05578, -0.056306, 0.013576, -0.008754, 0.129473, 0.010713, 0.107132, 0.053372, 0.049199, 0.025105, -0.046849, -0.022099, -0.007698, 0.069537, -0.060824, -0.007802, 0.051335, 0.028594, -0.113466, -0.007955, -0.051726, 0.01268, -0.058242, -0.035847, 0.010902]</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>N38324</td>\n","      <td>health</td>\n","      <td>medical</td>\n","      <td>how to get rid of skin tags, according to a dermatologist</td>\n","      <td>they seem harmless, but there's a very good reason you shouldn't ignore them. the post how to get rid of skin tags, according to a dermatologist appeared first on reader's digest.</td>\n","      <td>health medical how to get rid of skin tags according to a dermatologist they seem harmless but theres a very good reason you shouldnt ignore them the post how to get rid of skin tags according to a dermatologist appeared first on readers digest</td>\n","      <td>44</td>\n","      <td>[-0.002881, 0.004461749999999999, 0.0216455, -0.0319155, 0.01663025, 0.010054749999999998, -0.01916075, -0.021661, -0.01865675, 0.05306275, 0.05101875, 0.005004500000000002, 0.032266249999999996, -0.007904750000000002, -0.029127, 0.0254845, 0.0004097499999999995, -0.0067407499999999985, -0.013089, -0.0030437500000000004, -0.015913, -0.0433275, 0.011350749999999998, 0.0525345, -0.0008897500000000008, 0.02573975, -0.007651999999999997, -0.00929225, 0.0448065, 0.018117, -0.0359185, 0.03973525, -0.00552225, -0.008944, 0.01508225, -0.016991250000000003, 0.01503075, -0.0601835, -0.01010925, -0.02391925, -0.0075657499999999996, 0.028589999999999997, 0.002065249999999999, 0.031218000000000003, -0.0029339999999999995, -0.0020675, 0.022651249999999998, 0.0024807500000000003, -0.00855425, 0.0010757499999999999, -0.0507135, 0.04121725, -0.0025839999999999995, 0.03242725, 0.0178115, 0.028885249999999994, 0.0324305, 0.0028447499999999983, -0.0030939999999999995, -0.0057535, -0.05343825000000001, 0.0381715, 0.004730500000000004, 0.014446249999999999, 0.0025997500000000014, -0.04085825, -0.05733099999999999, -0.002074000000000001, 0.0099355, -0.007765749999999998, 0.016694999999999998, -0.03809125, -0.0006677500000000017, 0.03310325, -0.0072145, -0.009807249999999998, -0.06560475, 0.025306500000000003, 0.043265, 0.0157745, -0.01787275, 0.01142425, 0.0043125, 0.008035500000000001, 0.01093525, -0.06853875, 0.012272749999999999, -0.00288825, 0.018862249999999997, -0.032462000000000005, -0.025650000000000006, 0.0008900000000000002, -0.033017, -0.041723750000000004, 0.022862, -0.0597975, 0.030372500000000004, -0.070557, 0.03394275, 0.026708749999999996]</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-1647709e-cecd-47c4-bb7d-c7dca2299601')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-1647709e-cecd-47c4-bb7d-c7dca2299601 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-1647709e-cecd-47c4-bb7d-c7dca2299601');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":173}]},{"cell_type":"markdown","metadata":{"id":"C30kJ5gAJ57g"},"source":["### Transformations"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"p1xWKtd4hm3q"},"outputs":[],"source":["def get_sparse_matrix(behaviors):\n","\n","  behaviors['History'] = behaviors['History'].str.split()\n","\n","  # behaviors.reset_index(inplace=True)\n","\n","  # Create new column with list of user ID and time stamp\n","  behaviors['User_ID_Timestamp'] = behaviors['User ID'].astype(str) + ', ' + behaviors['Timestamp'].astype(str)\n","\n","  # Generate a list of unique articles from the 'articles_read' column\n","  articles = sorted(set(article for history in behaviors['History'] if isinstance(history, list) for article in history))\n","\n","  # Create a dictionary to map article IDs to column indices\n","  article_to_index = {article: index for index, article in enumerate(articles)}\n","\n","  # Create a dictionary to map user ID-timestamp combinations to indices\n","  user_id_timestamps = sorted(behaviors['User_ID_Timestamp'].unique())\n","  user_to_index = {user_id_timestamps: index for index, user_id_timestamps in enumerate(user_id_timestamps)}\n","\n","  # Create an empty sparse matrix with boolean values\n","  num_articles = len(articles)\n","  num_users = len(user_id_timestamps)\n","  sparse_matrix = lil_matrix((num_users, num_articles), dtype=bool)\n","\n","  # Fill the sparse matrix with user interactions\n","  for _, row in behaviors.iterrows():\n","      user_id = row['User_ID_Timestamp']\n","      user_index = user_to_index[user_id]  # Assuming user IDs start with 'user' followed by a number\n","      history = row['History']\n","      if isinstance(history, list):\n","          for article in history:\n","              if article in article_to_index:\n","                  article_index = article_to_index[article]\n","                  sparse_matrix[user_index, article_index] = True\n","      else:\n","          if history in article_to_index:\n","              article_index = article_to_index[history]\n","              sparse_matrix[user_index, article_index] = True\n","\n","  # Convert the sparse matrix to a DataFrame\n","  data_sparse = pd.DataFrame.sparse.from_spmatrix(sparse_matrix, columns=articles, index=user_id_timestamps)\n","\n","  data_sparse.reset_index(inplace=True)\n","\n","  # Extracting user id and timestamp from combined index column\n","  data_sparse['User ID'] = data_sparse['index'].str.split(',').str[0]\n","  data_sparse['Timestamp'] = data_sparse['index'].str.split(',').str[1]\n","\n","  # Dropping combined user_id & timestamp index column\n","  data_sparse.drop(columns='index',inplace=True)\n","\n","  # Moving the last two columns to the front\n","  # Get the column names of the last two columns\n","  last_two_columns = data_sparse.columns[-2:]\n","  # Recreating dataframe\n","  data_sparse = data_sparse[last_two_columns.tolist() + data_sparse.columns[:-2].tolist()]\n","\n","  return data_sparse"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uufLgpcwHCNt"},"outputs":[],"source":["data_sparse = get_sparse_matrix(behaviors)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IDCxnG67F8Cj"},"outputs":[],"source":["def get_release_date(data_sparse, news):\n","  # Sort the data_sparse DataFrame by the timestamp column\n","  sorted_sparse_df = data_sparse.sort_values(by='Timestamp')\n","\n","  # Find the release date of each news article\n","  release_dates = {}\n","\n","  # Iterate over the columns of data_sparse starting from the third column\n","  for col in sorted_sparse_df.columns[2:]:\n","      # Find the first index where the column has a value of 1\n","      first_nonzero_index = sorted_sparse_df[col].idxmax()\n","\n","      # Get the timestamp from the sorted_sparse_df using the first_nonzero_index\n","      timestamp = sorted_sparse_df.loc[first_nonzero_index, 'Timestamp']\n","\n","      # Store the release date in the release_dates dictionary with the article ID as the key\n","      release_dates[col] = timestamp\n","\n","  # Convert the release_dates dictionary into a DataFrame\n","  release_dates_df = pd.DataFrame(release_dates.items(), columns=['News ID', 'Release Date'])\n","\n","  # Join the two dataframes based on the 'news_id' column using left join\n","  news_dates = news.merge(release_dates_df, on='News ID', how='left')\n","\n","  news_dates['Release Date'] = pd.to_datetime(news_dates['Release Date'], errors='coerce')\n","\n","  # Fill the nulls with the first date\n","  news_dates['Release Date'].fillna(news_dates['Release Date'].min(), inplace=True)\n","\n","  return news_dates"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"kkzdivpPGT80"},"outputs":[],"source":["news = get_release_date(data_sparse, news)"]},{"cell_type":"markdown","metadata":{"id":"0t2AJzX-DbT5"},"source":["### Export to Pickle File"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QexdNqc5toQP"},"outputs":[],"source":["news.to_pickle(f\"/content/drive/MyDrive/Group_19/01.Dataset/{size}/Clean/{version}/news.pkl\")"]}],"metadata":{"colab":{"collapsed_sections":["lLQDzGBLrUnX","8bFG0ctWrZea","M1XvmAH3PnLT","A1VAsB8w-iDu","010ZMh6_RV1R","AXf-_G_aRZam","BYQpGFKLP56x","dFQnEX9Iux7J","Y_XaMmDCKCjx","C30kJ5gAJ57g"],"provenance":[{"file_id":"1gdvuqvAMhANCWnAb3AGb2KPsOM0OVfYA","timestamp":1687258022093}],"gpuType":"T4"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.9.7"}},"nbformat":4,"nbformat_minor":0}